#  Страница Детали заказа
from selenium.webdriver.common.by import By


class OrderDetailsLocators:
    """Страница Детали заказа"""

    @staticmethod
    def locator_header_order(num_order: str):
        """Локатор Заголовок заказа"""
        locator_header_order = (By.XPATH, f"//h1[contains(text(), 'Заказ {num_order}')]")
        return locator_header_order

    @staticmethod
    def locator_price_list_by_article(article: str):
        """Прайс-лист по артикулу"""
        locator_price_list_by_article = (
            By.XPATH,
            f"//span[contains(text(), '{article}')]//ancestor::div[@class='row gx-2 align-items-center'][2]//span[@class='d-flex text-nowrap']")
        return locator_price_list_by_article

    LOCATOR_H1_ORDER_IS_PLACED = (
        By.XPATH, "//h1[text()='Заказ размещается в учетной системе']")  # Заголовок Размещения закза
    LOCATOR_H1_ORDER = (By.XPATH, "//h1[contains(text(), 'Заказ')]")
    LOCATOR_H1_ORDER_PQ = (By.XPATH, "//h1[contains(text(), 'Проектное условие')]")
    LOCATOR_DIV_POSTED = (By.XPATH, "//div[contains(@class, 'bg-green-light') and text()='Размещен']")
    LOCATOR_CONTRACT_NUMBER = (
        By.XPATH, "//div[text()='Номер договора']/ following-sibling ::span[1]")  # Номер договора
    LOCATOR_DISTRIBUTOR = (
        By.XPATH, "//div[text()='Дистрибьютор']/ following-sibling ::span[1]")  # Дистрибьютор
    LOCATOR_PREPAYMENT_TERMS = (
        By.XPATH, "//div[text()='Условие оплаты']/ following-sibling ::span[1]")  # Условия предоплаты
    LOCATOR_CURRENCY = (
        By.XPATH, "//div[text()=' Валюта ']/ following-sibling ::span[1]")  # Курс валюты
    LOCATOR_COURSE_UE = (By.XPATH, "//div[text()=' Курс ']/ following-sibling ::span[1]")  # Курс уе
    LOCATOR_DELIVERY_METHOD = (
        By.XPATH, "//div[text()='Способ доставки']/ following-sibling ::span[1]")  # Способ доставки
    LOCATOR_AUTHOR_ORDER = (
        By.XPATH, "//div[text()='Автор заказа']/ following-sibling ::span[1]")  # Автор заказа
    LOCATOR_TOTAL_AMOUNT = (By.XPATH, "//div[text()='Общая сумма']/parent::div//div[2]")  # Общая сумма
    LOCATOR_TOTAL_WEIGHT = (By.XPATH, "//div[text()=' Общий вес ']/parent::div//div[2]")  # Общий вес
    LOCATOR_REFERENCE_NUMBER = (
        By.XPATH, "//div[text()=' Ссылочный номер ']/following-sibling::span[1]")  # Ссылочный номер
    LOCATOR_DELIVERY_ADDRESS = (
        By.XPATH, "//div[text()='Адрес доставки']/following-sibling::span[1]")  # Адрес доставки
    LOCATOR_OBJECT_DEAL = (By.XPATH, "//div[text()=' Объект / Сделка ']/parent::div//div[2]")  # Объект/Сделка
    LOCATOR_PRICE_ORDER = (By.XPATH, "//span[contains(text(), 'Итого: ')]/span")  # Сумма заказа
    LOCATOR_BUTTON_SEND_REQUEST = (
        By.XPATH, "//span[text()='Отправить запрос']/parent::button")  # Кнопка Отправить запрос
    LOCATOR_BUTTON_ORDER_CANCELLATION = (
        By.XPATH, "//span[text()='Отмена заказа']/parent::button")  # Кнопка Отмена заказа
    LOCATOR_BUTTON_DOCUMENTS_FOR_MATERIALS = (
        By.XPATH, "//span[text()='Документы к материалам']/parent::button")  # Кнопка Документы к материалам
    LOCATOR_BUTTON_DOWNLOAD_ALL_PASSPORTS = (
        By.XPATH, "//span[text()='Скачать все паспорта']/parent::button")  # Кнопка Скачать все паспорта
    LOCATOR_BUTTON_DOWNLOAD_ALL_CERTIFICATES = (
        By.XPATH, "//span[text()='Скачать все сертификаты']/parent::button")  # Кнопка Скачать все сертификаты
    LOCATOR_BUTTON_DOWNLOAD_ALL_MANUALS = (
        By.XPATH, "//span[text()='Скачать все руководства']/parent::button")  # Кнопка Скачать все руководства
    LOCATOR_PRINTING_FORMS = (By.XPATH, "//span[text()='Печатные формы']/parent::button")  # Кнопка Печатные формы
    LOCATOR_MENU_PRINTING_FORMS = (
        By.XPATH, "//div[@class='dropdown-menu py-2 show']")  # Выпадающий список меню печатных форм
    LOCATOR_EXPORT_TO_EXCEL = (By.XPATH, "//span[text()='Выгрузка в Excel']/parent::button")  # Кнопка Выгрузка в Excel
    LOCATOR_COMMERCIAL_OFFER_RIDAN = (
        By.XPATH,
        "//span[text()='Коммерческое предложение Ридан']/parent::button")  # Кнопка Коммерческое предложение Ридан
    LOCATOR_CHECK = (By.XPATH, "//span[text()='Счет']/parent::button")  # Кнопка Счет
    LOCATOR_CONFIRMATION = (By.XPATH, "//span[text()='Подтверждение']/parent::button")  # Кнопка Подтверждение

    LOCATOR_NAME_PTO = (By.XPATH, "//span[contains(text(), 'Аппарат теплообменный')]")  # Наименование материала в КП

    LOCATOR_COST_OF_DELIVERY = (By.XPATH, "//div[text()=' Стоимость доставки ']/following-sibling::span"
                                )  # Стоимость доставки
    LOCATOR_SURCHARGES_ON_ALL_ARTICLE_LINES_IN_ORDER = (By.XPATH, "//div[@class='col-4 col-lg mb-2 mb-lg-0']"
                                                        )  # Надбавки на всех линиях артикулов
    LOCATOR_TERMS_OF_PAYMENT_IN_ORDER = (By.XPATH, "//div[text()='Условие оплаты']/following-sibling::span"
                                         )  # Условия оплаты на странице Заказа
    LOCATOR_ALL_DISCOUNTS = (By.XPATH, "//div[@class='col-4 col-lg mb-3 mb-lg-0' and contains(., '%')]"
                             )  # Скидки на всех линиях заказа
    LOCATOR_BTN_SHOW_REQUEST_HISTORY = (By.XPATH, "//span[contains(text(), 'Показать историю запросов')]/parent::button"
                                        )  # Копка Показать историю запросов
    LOCATOR_BTN_LIST_REQUEST = (By.XPATH, "//button[@class='icon-w-count btn border-0 bg-transparent p-0']"
                                )  # Кнопка Список запросов
    LOCATOR_HEADER_IN_MODAL_LIST_REQUESTS = (
        By.XPATH, "//div[@class='modal-content']//div[contains(., 'Список запросов')]"
    )  # Заголовок в модалке Список запросов
    LOCATOR_NUM_REQUEST_IN_MODAL_LIST_REQUESTS = (By.XPATH, "//div[@class='row border-top']/div[1]"
                                                  )  # Номер запроса в модалке Список запросов
    LOCATOR_BUTTON_POSITION_HISTORY = (
        By.XPATH, "//*[local-name() = 'svg' and @class='flex-shrink-0 ms-1 cursor-pointer']"
    )  # Кнопка История позиции
    LOCATOR_HEADER_IN_MODAL_POSITION_HISTORY = (By.XPATH, "//div[contains(., 'История по позиции')]"
                                                )  # Заголовок в модалке История позиций
    LOCATOR_DATE_IN_MODAL_POSITION_HISTORY = (By.XPATH, "//div[@class='fw-bold']")  # Дата в модалке История позиций
    LOCATOR_STATUS_IN_MODAL_POSITION_HISTORY = (
        By.XPATH, "//div[contains(@class, 'position-relative')]//span[@class='ps-3']"
    )  # Статус в модалке История позиций
    LOCATOR_BTN_CLOSE_IN_MODAL_POSITION_HISTORY = (
        By.XPATH, "//div[@id='modalPositionStory']//button[@class='btn-close p-1 fs-5']"
    )  # Кнопка Закрыть в модалке История позиций
    LOCATOR_NAME_ARTICLE = (
        By.XPATH,
        "//div[@class='row gx-2 align-items-center position-relative']//span[@class='text-break d-inline-flex']"
    )  # Наименование артикула
    LOCATOR_BTN_COPY_KP = (By.XPATH, "//span[text()='Копировать КП']/parent::button"
                           )  # Кнопка Копировать КП
    LOCATOR_BTN_TOOLTIP_ARTICLE = (By.XPATH, "//div[@class='d-inline-block white-tooltip tooltip__min-table']//i"
                                   )  # Кнопка Тултипа у артикула
    LOCATOR_HEADER_IN_TOOLTIP_COMPOSITION_OF_SET = (By.XPATH, "//h6[contains(text(), 'Состав комплекта:')]"
                                                    )  # Заголовок Состав комплекта в тултипе состава омплекта БОМов


class ModalWindowCancelOrderLocators:
    """Модалка Отмена заказа"""
    LOCATOR_H3 = (By.XPATH, "//h3[text()='Отмена заказа']")  # Заголовок Отмена заказа
    LOCATOR_BUTTON_IN_MODAL_SEND_REQUEST = (
        By.XPATH, "//div[@id='modalRefusalOrder']//span[text()='Отправить запрос']/parent::button"
    )  # Кнопка Отправить запрос
    LOCATOR_MESSAGE_ABOUT_THE_NEED_TO_CHOOSE_A_REASON = (
        By.XPATH, "//div[@data-validate-error-info-container='form-refusal-order']//span"
    )  # Сообщение о необходимости выбора причины
    LOCATOR_CAUSE_LIST_SHOW = (
        By.XPATH, "//span[contains(text(), 'Выберите из списка')]/parent::div")  # Показ выпадающего списка причин
    LOCATOR_UL_ACTIVE_CAUSE = (By.XPATH, "//div[contains(@class, 'active')]/ul[@data-id='-single-select-box']"
                               )  # Активный выпадающий список Причина
    LOCATOR_ITEM_CAUSE_PLACEMENT_ERROR = (
        By.XPATH, "//span[text()='Ошибка при размещении заказа']"
    )  # Пункт "Ошибка при размещении заказа" в выпадающем списке причин
    LOCATOR_INPUT_REASON = (By.XPATH, "//input[@name='reason']")  # инпут Причина
    LOCATOR_MODAL_REQUEST_RESULT = (By.XPATH, "//div[@class='modal-body']")
    LOCATOR_HEADER_SUCCESSFUL_REQUEST_CREATION = (By.XPATH, "//div[contains(text(), 'успешно создан')]"
                                                  )  # Заголовок Запрос успешно создан
    LOCATOR_INPUT_COMMENT = (By.XPATH, "//input[@name='commentary']")  # Поле ввода комментария
    LOCATOR_BUTTON_CLOSE_MODAL_REQUEST_RESULT = (
        By.XPATH, "//button[text()='Закрыть']")  # Кнопка Закрыть в модалке с результатом запроса
    LOCATOR_RESPONSE_JSON_TST = (By.XPATH, "//pre[@class='fs-6']")  # Ответ в виде json, тестовый режим
    LOCATOR_BTN_CLOSE_IN_MODAL_CANCEL_ORDER = (By.XPATH, "//span[contains(text(), 'Закрыть')]/parent::button"
                                               )  # Кнопка Закрыть в модалке Отмена заказа
    LOCATOR_PRICE_IN_MODAL_CANCEL_ORDER = (By.XPATH, "//span[contains(text(), 'Сумма:')]"
                                           )  # Сумма в модалке Отмена заказа
