
from selenium.webdriver.common.by import By
from selenium.common import NoSuchElementException
from selenium.webdriver.support.wait import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.keys import Keys
import allure
import time
from open_pages.btp_service_page.btp_service_locators import AuthPageLocators, BTPServicePageLocators
from base_page.base_page import BasePage
from config import TestEnvironment
from tools.logger import btp_logger as logger
from bs4 import BeautifulSoup


class AuthPage(BasePage):
    """–ö–ª–∞—Å—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"""

    def __init__(self, browser, url=TestEnvironment.BTP_BASE_URL):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"""
        super().__init__(browser, url)
        logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏")

    @allure.step("–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: {order_number}")
    def login(self, order_number=TestEnvironment.BTP_DEFAULT_ORDER_NUMBER, pin_code=TestEnvironment.BTP_DEFAULT_PIN_CODE):
        """–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –æ–∂–∏–¥–∞–Ω–∏–µ–º –ª–æ–∞–¥–µ—Ä–∞"""
        logger.info(f"–ù–∞—á–∞–ª–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏: {order_number}/{pin_code}")
        self.open()

        with allure.step("–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"):
            self.waiting_element_is_visibility_located_dom(AuthPageLocators.ORDER_NUMBER_INPUT)
            logger.debug("–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")

        with allure.step(f"–í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞: {order_number}"):
            order_input = self.find_element(AuthPageLocators.ORDER_NUMBER_INPUT)
            order_input.clear()
            order_input.send_keys(order_number)
            logger.debug(f"–í–≤–µ–¥–µ–Ω –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: {order_number}")

        with allure.step(f"–í–≤–æ–¥ –ø–∏–Ω-–∫–æ–¥–∞: {pin_code}"):
            pin_input = self.find_element(AuthPageLocators.PIN_CODE_INPUT)
            pin_input.clear()
            pin_input.send_keys(pin_code)
            logger.debug(f"–í–≤–µ–¥–µ–Ω –ø–∏–Ω-–∫–æ–¥: {pin_code}")

        with allure.step("–ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞"):
            self.find_element(AuthPageLocators.SUBMIT_BUTTON).click()
            logger.debug("–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–∂–∞—Ç–∞")

        # –û–∂–∏–¥–∞–µ–º –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –ª–æ–∞–¥–µ—Ä–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º 60 —Å–µ–∫—É–Ω–¥
        with allure.step("–û–∂–∏–¥–∞–Ω–∏–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –ª–æ–∞–¥–µ—Ä–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
            self._wait_for_spinner_border_disappear(60)
            logger.debug("–õ–æ–∞–¥–µ—Ä –∏—Å—á–µ–∑, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...")

        try:
            with allure.step("–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–∫–∞–∑–∞"):
                self.waiting_element_is_visibility_located_dom(
                    (By.XPATH, "//div[@class='fs-5 fw-bold'][contains(text(), '–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞')]"),
                    sec=20
                )
                logger.debug("–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫–∞–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
        except Exception:
            logger.error("–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–∞")
            return False

        # –ñ–¥–µ–º —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ URL
        with allure.step(f"–û–∂–∏–¥–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ URL –∑–∞–∫–∞–∑–∞: {order_number}"):
            wait = WebDriverWait(self.driver, TestEnvironment.BROWSER_TIMEOUT)
            wait.until(EC.url_contains(f"/{order_number}"))
            logger.debug(f"URL —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: {order_number}")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
        current_url = self.driver.current_url
        success = current_url == f"{TestEnvironment.BTP_BASE_URL}/{order_number}"

        if success:
            logger.info(f"–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞: {current_url}")
        else:
            logger.error(
                f"–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å. –¢–µ–∫—É—â–∏–π URL: {current_url}, –æ–∂–∏–¥–∞–µ–º—ã–π: {TestEnvironment.BTP_BASE_URL}/{order_number}")

        return success

    def _wait_for_spinner_border_disappear(self, timeout_seconds=60):
        """
        –û–∂–∏–¥–∞–Ω–∏–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –ª–æ–∞–¥–µ—Ä–∞ —Å –∫–ª–∞—Å—Å–æ–º spinner-border.

        Args:
            timeout_seconds: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        """
        logger.info(f"–û–∂–∏–¥–∞–Ω–∏–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –ª–æ–∞–¥–µ—Ä–∞ spinner-border (—Ç–∞–π–º–∞—É—Ç: {timeout_seconds} —Å–µ–∫)")

        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º —Ç–∞–π–º–∞—É—Ç–æ–º
            wait = WebDriverWait(self.driver, timeout_seconds)
            wait.until(EC.invisibility_of_element_located((By.CSS_SELECTOR, "div.spinner-border")))
            logger.info("–õ–æ–∞–¥–µ—Ä spinner-border –∏—Å—á–µ–∑")
            return True
        except Exception as e:
            logger.warning(f"–ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ –æ–∂–∏–¥–∞–Ω–∏–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –ª–æ–∞–¥–µ—Ä–∞ spinner-border: {e}")

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –ª–æ–∞–¥–µ—Ä–∞
            try:
                header_present = self.driver.find_elements(
                    By.XPATH, "//div[@class='fs-5 fw-bold'][contains(text(), '–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞')]"
                )
                if header_present:
                    logger.info(
                        "–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –ª–æ–∞–¥–µ—Ä–æ–º, —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –ø–æ—Ö–æ–∂–µ, –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å (–Ω–∞–π–¥–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–∫–∞–∑–∞)")
                    return True
            except:
                pass

            return False


class BTPServicePage(BasePage):
    """–ö–ª–∞—Å—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–∞ –ë–¢–ü"""

    def __init__(self, browser, json_handler=None, order_number=None):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–∞ –ë–¢–ü"""
        super().__init__(browser, TestEnvironment.BTP_BASE_URL)
        self.json_handler = json_handler
        self.order_number = order_number
        # –ö—ç—à –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        self._cache = {}
        logger.info(f"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ BTPServicePage —Å –∑–∞–∫–∞–∑–æ–º {order_number}")

    @allure.step("–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ JSON")
    def set_json_handler(self, json_handler):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ JSON –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫"""
        self.json_handler = json_handler
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—ç—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
        self._cache = {}
        logger.info("–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã BTP")

    @allure.step("–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞: {order_number}")
    def set_order_number(self, order_number):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫"""
        self.order_number = order_number
        logger.info(f"–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: {order_number}")

    @allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")
    def get_order_number(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        order_number_elem = self.find_element(BTPServicePageLocators.ORDER_NUMBER_HEADER)
        order_number = order_number_elem.text.strip()
        logger.info(f"–ü–æ–ª—É—á–µ–Ω –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {order_number}")
        return order_number

    @allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")
    def get_order_status(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        logger.info("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")
        try:
            # –ù–∞—Ö–æ–¥–∏–º –±–ª–æ–∫ "–ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞"
            status_block = self.driver.find_element(By.XPATH,
                                                    "//p[contains(text(), '–ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞')]/following-sibling::ul[@class='list-unstyled']")
            logger.debug("–ù–∞–π–¥–µ–Ω –±–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞")

            # –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã li –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
            status_items = status_block.find_elements(By.TAG_NAME, "li")
            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(status_items)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç–∞—Ç—É—Å–∞")

            statuses = []
            for item in status_items:
                # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏ —É–¥–∞–ª—è–µ–º —á–∞—Å—Ç—å "–ø–æ–¥—Ä–æ–±–Ω–µ–µ"
                status_text = item.text.strip()
                if "\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ" in status_text:
                    status_text = status_text.replace("\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ", "")
                statuses.append(status_text)
                logger.debug(f"–ü–æ–ª—É—á–µ–Ω —Å—Ç–∞—Ç—É—Å: {status_text}")

            return statuses
        except NoSuchElementException:
            logger.warning("–ù–µ –Ω–∞–π–¥–µ–Ω –±–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞, –∏—Å–ø–æ–ª—å–∑—É—é –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç")
            # –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: –∏—â–µ–º –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–≤—ã–π —Å–ø–∏—Å–æ–∫ list-unstyled –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            try:
                first_list = self.driver.find_element(By.CSS_SELECTOR, "ul.list-unstyled")
                status_items = first_list.find_elements(By.TAG_NAME, "li")
                statuses = []
                for item in status_items:
                    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –∏ —É–¥–∞–ª—è–µ–º —á–∞—Å—Ç—å "–ø–æ–¥—Ä–æ–±–Ω–µ–µ"
                    status_text = item.text.strip()
                    if "\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ" in status_text:
                        status_text = status_text.replace("\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ", "")
                    statuses.append(status_text)
                    logger.debug(f"–ü–æ–ª—É—á–µ–Ω —Å—Ç–∞—Ç—É—Å (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç 1): {status_text}")
                return statuses
            except NoSuchElementException:
                logger.warning("–ù–µ –Ω–∞–π–¥–µ–Ω —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é –≤—Ç–æ—Ä–æ–π –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç")
                # –ö—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π - –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ–∫–∞—Ç–æ—Ä
                status_items = self.find_elements(BTPServicePageLocators.STATUS_ITEMS)
                statuses = []
                for item in status_items:
                    status_text = item.text.strip()
                    if "\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ" in status_text:
                        status_text = status_text.replace("\n–ø–æ–¥—Ä–æ–±–Ω–µ–µ", "")
                    statuses.append(status_text)
                    logger.debug(f"–ü–æ–ª—É—á–µ–Ω —Å—Ç–∞—Ç—É—Å (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç 2): {status_text}")
                return statuses

    @allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")
    def get_articles(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        logger.info("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")

        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –ø–æ–ª—É—á–µ–Ω—ã
        if 'articles' in self._cache:
            logger.debug("–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã")
            return self._cache['articles']

        articles = []

        # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ —Å –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏
        with allure.step("–ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ —Å –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏"):
            accordion_items = self.find_elements(BTPServicePageLocators.ARTICLE_ACCORDION_ITEMS)
            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(accordion_items)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")

        for item in accordion_items:
            try:
                # –ò—â–µ–º –Ω–æ–º–µ—Ä –∞—Ä—Ç–∏–∫—É–ª–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                article_element = item.find_element(*BTPServicePageLocators.ARTICLE_HEADERS)
                article_number = article_element.text.strip()

                if article_number:
                    articles.append(article_number)
                    logger.debug(f"–ù–∞–π–¥–µ–Ω –∞—Ä—Ç–∏–∫—É–ª: {article_number}")
            except NoSuchElementException:
                logger.warning("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞—Ä—Ç–∏–∫—É–ª–∞ –≤ —ç–ª–µ–º–µ–Ω—Ç–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")
                continue

        logger.info(f"–í—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ {len(articles)} –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à–µ
        self._cache['articles'] = articles
        return articles

    @allure.step("–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞")
    def close_popup(self):
        """–ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ø–∞–ø, –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç."""
        logger.info("–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø, –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç")
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ–ø–∞–ø
            popup_elements = self.driver.find_elements(*BTPServicePageLocators.POPUP_DIALOG)
            if len(popup_elements) > 0 and popup_elements[0].is_displayed():
                logger.debug("–ù–∞–π–¥–µ–Ω –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ–ø–∞–ø")
                close_button = popup_elements[0].find_element(*BTPServicePageLocators.POPUP_CLOSE_BUTTON)
                close_button.click()
                logger.debug("–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è")

                # –ñ–¥–µ–º –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –ø–æ–ø–∞–ø–∞
                wait = WebDriverWait(self.driver,TestEnvironment.BROWSER_TIMEOUT)
                wait.until(EC.invisibility_of_element_located(BTPServicePageLocators.POPUP_DIALOG))
                logger.info("–ü–æ–ø–∞–ø —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã—Ç")
                return True
        except Exception as e:
            logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞: {e}")
            pass

        logger.debug("–û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ–ø–∞–ø –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–∂–µ –∑–∞–∫—Ä—ã—Ç")
        return False

    # –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ç–∞–ø–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤")
    def verify_stages_one_by_one(self):
        """
        –°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ç–∞–ø–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤.
        –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑ –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è,
        –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏ Python.
        """
        if not self.json_handler:
            logger.error("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            raise ValueError("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        logger.info("–ù–∞—á–∏–Ω–∞–µ–º —Å–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —ç—Ç–∞–ø–æ–≤ –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤...")

        # 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON
        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —ç—Ç–∞–ø–∞—Ö –∏–∑ JSON"):
            json_data = self._get_json_stages_data()
            logger.debug(f"–°–æ–±—Ä–∞–Ω–æ –∏–∑ JSON: {len(json_data)} –∞—Ä—Ç–∏–∫—É–ª–æ–≤")

        # 2. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ HTML —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
            page_html = self._get_html_content()
            logger.debug(f"–ü–æ–ª—É—á–µ–Ω HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–º {len(page_html)} —Å–∏–º–≤–æ–ª–æ–≤")

        # 3. –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ HTML
        with allure.step("–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —ç—Ç–∞–ø–∞—Ö –∏–∑ HTML"):
            page_data = self._parse_html_for_stages(page_html)
            logger.info(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ HTML –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è: {len(page_data)} –∞—Ä—Ç–∏–∫—É–ª–æ–≤")

        # 4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞"):
            results = self._compare_and_report_stages(json_data, page_data)

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        all_match = all(r['match'] for r in results)

        # –í—ã–≤–æ–¥–∏–º –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        logger.info("=" * 80)
        logger.info("–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê")
        logger.info("=" * 80)

        matches = sum(1 for r in results if r['match'])
        logger.info(f"–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∞—Ä—Ç–∏–∫—É–ª–æ–≤: {len(results)}")
        logger.info(f"–°–æ–≤–ø–∞–¥–µ–Ω–∏–π: {matches}")
        logger.info(f"–ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: {len(results) - matches}")
        logger.info(f"–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {'‚úì' if all_match else '‚úó'}")

        return all_match, results

    def _get_json_stages_data(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —ç—Ç–∞–ø–∞—Ö –∏–∑ JSON —Å —É—á–µ—Ç–æ–º –≥—Ä—É–ø–ø—ã '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'"""
        logger.debug("–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —ç—Ç–∞–ø–∞—Ö –∏–∑ JSON")
        json_data = {}

        for item in self.json_handler.get_order_items():
            article = item.get('materialCode')
            if not article:
                continue

            article_data = {'Process': [], 'Finish': [], 'Wait': []}

            # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º
            production_stages = {
                'Process': [], 'Finish': [], 'Wait': []
            }

            for step in item.get('progressSteps', []):
                status_type = step.get('status')
                if status_type not in article_data:
                    continue

                text = step.get('description', '').lower()
                if text:
                    article_data[status_type].append(text)

                # –ü—Ä–æ–≤–µ—Ä—è–µ–º groupName —ç—Ç–∞–ø–∞
                group_name = step.get('groupName', '').lower()

                # –ï—Å–ª–∏ —ç—Ç–æ –≥—Ä—É–ø–ø–∞ "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ", –∑–∞–ø–æ–º–∏–Ω–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ
                if group_name == '–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ':
                    production_stages[status_type].append(text)

            # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö –≤ –¥–∞–Ω–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª–∞
            json_data[article] = {
                **article_data,
                'production_stages': production_stages
            }

        logger.debug(f"–°–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ —ç—Ç–∞–ø–∞—Ö –¥–ª—è {len(json_data)} –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ JSON")
        return json_data

    def _get_html_content(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ HTML-—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        logger.debug("–ü–æ–ª—É—á–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...")

        try:
            all_accordion_container = self.driver.find_element(By.CSS_SELECTOR, "div.accordion")
            page_html = all_accordion_container.get_attribute('outerHTML')
            logger.debug(f"–ü–æ–ª—É—á–µ–Ω HTML –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞, —Ä–∞–∑–º–µ—Ä: {len(page_html)} —Å–∏–º–≤–æ–ª–æ–≤")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ HTML –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞: {e}")
            # –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - –ø–æ–ª—É—á–∞–µ–º HTML –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            page_html = self.driver.find_element(By.TAG_NAME, "body").get_attribute('outerHTML')
            logger.warning(f"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - HTML –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —Ä–∞–∑–º–µ—Ä: {len(page_html)} —Å–∏–º–≤–æ–ª–æ–≤")

        return page_html

    def _parse_html_for_stages(self, page_html):
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —ç—Ç–∞–ø–∞—Ö –∏–∑ HTML"""
        global article
        logger.info("–û–±—Ä–∞–±–æ—Ç–∫–∞ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã...")

        soup = BeautifulSoup(page_html, 'html.parser')

        # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã
        accordion_items = soup.select("div.accordion-item")
        logger.debug(f"–ù–∞–π–¥–µ–Ω–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –≤ HTML: {len(accordion_items)}")

        # –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        page_data = {}

        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –∞–∫–∫–æ—Ä–¥–µ–æ–Ω
        for item in accordion_items:
            try:
                # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –∞—Ä—Ç–∏–∫—É–ª–∞
                header = item.select_one("div.fs-4.fw-bold")
                if not header:
                    continue

                article = header.get_text().strip()
                if not article:
                    continue

                logger.debug(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: {article}")

                # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞
                page_data[article] = {'Process': [], 'Finish': [], 'Wait': []}

                # –ù–∞—Ö–æ–¥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ - div —Å –∫–ª–∞—Å—Å–æ–º accordion-body
                accordion_body = self._find_accordion_body(item)

                if not accordion_body:
                    logger.warning(f"–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ –¥–ª—è {article}")
                    continue

                logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ –¥–ª—è {article}")

                # –ò–∑–≤–ª–µ–∫–∞–µ–º —ç—Ç–∞–ø—ã –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞
                self._extract_stages_from_accordion(accordion_body, page_data[article])

                # –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö
                logger.debug(f"–≠—Ç–∞–ø—ã –¥–ª—è {article}: Process={len(page_data[article]['Process'])}, " +
                             f"Finish={len(page_data[article]['Finish'])}, Wait={len(page_data[article]['Wait'])}")

            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞—Ä—Ç–∏–∫—É–ª–∞ {article}: {e}")

        return page_data

    def _find_accordion_body(self, accordion_item):
        """–ü–æ–∏—Å–∫ —Ç–µ–ª–∞ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ –≤ HTML"""
        logger.debug("–ü–æ–∏—Å–∫ —Ç–µ–ª–∞ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")
        accordion_body = accordion_item.select_one("div.accordion-body")
        if not accordion_body:
            # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –∏—â–µ–º –ø–æ id
            logger.debug("–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Ç–µ–ª–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ –ø–æ –ø—Ä—è–º–æ–º—É —Å–µ–ª–µ–∫—Ç–æ—Ä—É, –ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç")
            accordion_collapse = accordion_item.select_one("div.accordion-collapse")
            if accordion_collapse:
                accordion_body = accordion_collapse.select_one("div.accordion-body")

        return accordion_body

    def _extract_stages_from_accordion(self, accordion_body, article_data):
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –∏–∑ —Ç–µ–ª–∞ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ —Å –æ—Å–æ–±–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤"""
        logger.debug("–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –∏–∑ —Ç–µ–ª–∞ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")
        # –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å —ç—Ç–∞–ø–∞–º–∏ - –æ–Ω–∏ –≤ div —Å –∫–ª–∞—Å—Å–∞–º–∏ d-flex align-items-center
        stage_containers = accordion_body.select("div.d-flex.align-items-center")
        logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(stage_containers)} –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å —ç—Ç–∞–ø–∞–º–∏")

        for container in stage_containers:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—É
            status_type = self._detect_status_type(container)

            if not status_type:
                continue

            # –ò—â–µ–º —Ç–µ–∫—Å—Ç —ç—Ç–∞–ø–∞ - –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ div —Ä—è–¥–æ–º —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º
            stage_text_elem = container.select_one("div.fs-5") or container.select_one(
                "div.fs-6") or container.select_one("div.text-gray")

            if stage_text_elem:
                text = stage_text_elem.get_text().strip().lower()
                if text and text not in ['', '.', '–ø–æ–¥—Ä–æ–±–Ω–µ–µ']:
                    article_data[status_type].append(text)
                    logger.debug(f"–î–æ–±–∞–≤–ª–µ–Ω —ç—Ç–∞–ø —Ç–∏–ø–∞ {status_type}: {text}")

                    # –ï—Å–ª–∏ —ç—Ç–æ —ç—Ç–∞–ø –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                    if "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ" in text:
                        if 'production_stages' not in article_data:
                            article_data['production_stages'] = {'Process': [], 'Finish': [], 'Wait': []}
                        article_data['production_stages'][status_type].append(text)
                        logger.debug(f"–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —ç—Ç–∞–ø —Ç–∏–ø–∞ {status_type}: {text}")

    def _detect_status_type(self, container):
        """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—É"""
        if container.select_one("i.service-btp_icon--blue") or container.select_one(
                "svg.text-primary") or container.select_one("[class*='blue']"):
            return 'Process'
        elif container.select_one("i.service-btp_icon--green") or container.select_one(
                "svg.text-success") or container.select_one("[class*='green']"):
            return 'Finish'
        elif container.select_one("i.service-btp_icon--gray") or container.select_one(
                "svg.text-secondary") or container.select_one("[class*='gray']"):
            return 'Wait'
        return None

    def _compare_and_report_stages(self, json_data, page_data):
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ —Å —É—á–µ—Ç–æ–º –≥—Ä—É–ø–ø—ã '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'"""
    logger.info("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã")
    results = []

    # –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
    logger.info("=" * 80)
    logger.info("–î–ï–¢–ê–õ–¨–ù–´–ô –í–´–í–û–î –í–°–ï–• –≠–¢–ê–ü–û–í –î–õ–Ø –ö–ê–ñ–î–û–ì–û –ê–†–¢–ò–ö–£–õ–ê")
    logger.info("=" * 80)

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –∞—Ä—Ç–∏–∫—É–ª—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞
    all_articles = sorted(list(set(list(json_data.keys()) + list(page_data.keys()))))

    for article in all_articles:
        logger.info(f"\n–ê–†–¢–ò–ö–£–õ: {article}")
        logger.info("-" * 50)

        json_article_data = json_data.get(article, {})
        page_article_data = page_data.get(article, {})

        article_match = True
        mismatches = []

        # –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
        production_mismatch = self._check_production_logic(article, json_article_data, page_article_data)
        if production_mismatch:
            article_match = False
            mismatches.append(production_mismatch)

        # –£–î–ê–õ–Ø–ï–ú –ù–ï–ü–†–ê–í–ò–õ–¨–ù–£–Æ –ü–†–û–í–ï–†–ö–£!
        # –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –±—ã–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π - –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –í–°–ï –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ,
        # –∞ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —ç—Ç–∞–ø

        # –û–†–ò–ì–ò–ù–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤
        for status_type in ['Process', 'Finish', 'Wait']:
            json_stages = json_article_data.get(status_type, [])
            page_stages = page_article_data.get(status_type, [])


            # –ò–°–ö–õ–Æ–ß–ê–ï–ú —ç—Ç–∞–ø—ã "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ" –∏–∑ –æ–±—ã—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏!
            # –û–Ω–∏ —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
            filtered_page_stages = []
            for stage in page_stages:
                if "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ" not in self._normalize_stage_text(stage):
                    filtered_page_stages.append(stage)
                else:
                    logger.debug(f"–ò—Å–∫–ª—é—á–∞–µ–º —ç—Ç–∞–ø –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏–∑ –æ–±—ã—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: {stage}")
            
            page_stages = filtered_page_stages
            
            # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å—Ç–∞—Ç—É—Å–∞
            logger.info(f"\n–°—Ç–∞—Ç—É—Å: {status_type} (–±–µ–∑ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞)")
            logger.info(f"  –í UI ({len(page_stages)}):")
            for stage in page_stages:
                logger.info(f"    - {stage}")

            logger.info(f"  –í JSON ({len(json_stages)}):")
            for stage in json_stages:
                logger.info(f"    - {stage}")

            # –ï—Å–ª–∏ –Ω–µ—Ç —ç—Ç–∞–ø–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
            if not page_stages:
                logger.info("  –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ—Ç —ç—Ç–∞–ø–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è")
                continue

            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç—ã —ç—Ç–∞–ø–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            json_stages_norm = [self._normalize_stage_text(stage) for stage in json_stages]
            page_stages_norm = [self._normalize_stage_text(stage) for stage in page_stages]

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –∏–∑ UI –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ JSON
            missing_stages = []

            for i, page_stage in enumerate(page_stages_norm):
                found = False
                for json_stage in json_stages_norm:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–µ–∫—Å—Ç —ç—Ç–∞–ø–∞ –∏–∑ UI —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ JSON –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç
                    if (page_stage in json_stage) or (json_stage in page_stage):
                        found = True
                        break

                if not found:
                    missing_stages.append(page_stages[i])

            # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            if missing_stages:
                logger.warning("  –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úó –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ!")
                logger.warning("  –≠—Ç–∞–ø—ã –∏–∑ UI, –Ω–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ JSON:")
                for stage in missing_stages:
                    logger.warning(f"    - {stage}")

                article_match = False
                mismatches.append({
                    'status_type': status_type,
                    'json_stages': json_stages,
                    'page_stages': page_stages,
                    'missing_in_json': missing_stages
                })
            else:
                logger.info("  –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úì –í—Å–µ —ç—Ç–∞–ø—ã –∏–∑ UI –Ω–∞–π–¥–µ–Ω—ã –≤ JSON")

        results.append({
            'article': article,
            'match': article_match,
            'mismatches': mismatches
        })

    return results
    

    def _find_production_stage_in_ui(self, page_article_data):
        """
        –ù–∞—Ö–æ–¥–∏—Ç —ç—Ç–∞–ø –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –≤ –¥–∞–Ω–Ω—ã—Ö UI
        """
        for status_type in ['Process', 'Finish', 'Wait']:
            for stage_text in page_article_data.get(status_type, []):
                if "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ" in self._normalize_stage_text(stage_text):
                    return {
                        'color': status_type,
                        'text': stage_text
                    }
        return None

    def _get_expected_production_display(self, production_stages, is_outsource):
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–π —Ü–≤–µ—Ç –∏ —Ç–µ–∫—Å—Ç –¥–ª—è —ç—Ç–∞–ø–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
        
        –õ–æ–≥–∏–∫–∞:
        - –¶–≤–µ—Ç: Process > Finish > Wait
        - –¢–µ–∫—Å—Ç –¥–ª—è isOutsource=true: –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"  
        - –¢–µ–∫—Å—Ç –¥–ª—è isOutsource=false: "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.{—ç—Ç–∞–ø}" –≥–¥–µ —ç—Ç–∞–ø –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É:
          Process (–ø–µ—Ä–≤—ã–π) > Finish (–ø–æ—Å–ª–µ–¥–Ω–∏–π) > Wait (–ø–µ—Ä–≤—ã–π)
        """
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–∂–∏–¥–∞–µ–º—ã–π —Ü–≤–µ—Ç –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
        if production_stages.get('Process'):
            expected_color = 'Process'
        elif production_stages.get('Finish'):
            expected_color = 'Finish'
        elif production_stages.get('Wait'):
            expected_color = 'Wait'
        else:
            expected_color = 'Wait'  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–∂–∏–¥–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç
        if is_outsource:
            # –î–ª—è –∞—É—Ç—Å–æ—Ä—Å–∞ ‚Üí –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"
            expected_text = "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"
        else:
            # –î–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ ‚Üí "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.{–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π_—ç—Ç–∞–ø}"
            if production_stages.get('Process'):
                # –ï—Å–ª–∏ –µ—Å—Ç—å Process —ç—Ç–∞–ø—ã ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π Process —ç—Ç–∞–ø
                expected_text = f"–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.{production_stages['Process'][0]}"
            elif production_stages.get('Finish'):
                # –ï—Å–ª–∏ –Ω–µ—Ç Process, –Ω–æ –µ—Å—Ç—å Finish ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π Finish —ç—Ç–∞–ø
                expected_text = f"–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.{production_stages['Finish'][-1]}"
            elif production_stages.get('Wait'):
                # –ï—Å–ª–∏ –Ω–µ—Ç Process –∏ Finish, –Ω–æ –µ—Å—Ç—å Wait ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π Wait —ç—Ç–∞–ø
                expected_text = f"–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.{production_stages['Wait'][0]}"
            else:
                # –ï—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ ‚Üí –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"
                expected_text = "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"

        return expected_color, expected_text

    def _normalize_stage_text(self, text):
        """
        –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —ç—Ç–∞–ø–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        
        –£–¥–∞–ª—è–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–µ UI-–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è: "(–≤ —Ä–∞–±–æ—Ç–µ)", –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫, –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        –ó–∞–º–µ–Ω—è–µ—Ç –∑–Ω–∞–∫–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–±–µ–ª—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        """
        if not text:
            return ""

        # –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
        text = text.lower().strip()
        
        # –£–¥–∞–ª—è–µ–º –≤–∞–ª–∏–¥–Ω—ã–µ UI-–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        text = text.replace('(–≤ —Ä–∞–±–æ—Ç–µ)', '')  # UI –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å "(–≤ —Ä–∞–±–æ—Ç–µ)"
        text = text.replace('\n', ' ')         # –£–±–∏—Ä–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        
        # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ó–∞–º–µ–Ω—è–µ–º —Ç–æ—á–∫–∏ –∏ –∑–∞–ø—è—Ç—ã–µ –Ω–∞ –ø—Ä–æ–±–µ–ª—ã, –∞ –Ω–µ —É–¥–∞–ª—è–µ–º –∏—Ö!
        text = text.replace('.', ' ').replace(',', ' ')

        # –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã (–º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ä—è–¥ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω)
        text = ' '.join(text.split())

        return text

    def _check_production_logic(self, article, json_article_data, page_article_data):
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –¥–ª—è —ç—Ç–∞–ø–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
        
        –£—á–∏—Ç—ã–≤–∞–µ—Ç isOutsource –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–π –≤–∏–¥ —ç—Ç–∞–ø–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –≤ UI
        """
        logger.info(f"\nüè≠ –ü–†–û–í–ï–†–ö–ê –õ–û–ì–ò–ö–ò –ü–†–û–ò–ó–í–û–î–°–¢–í–ê –¥–ª—è {article}")

        # –ü–æ–ª—É—á–∞–µ–º isOutsource –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞
        is_outsource = self.json_handler.get_is_outsource(article)
        logger.info(f"  isOutsource: {is_outsource}")

        # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã –∏–∑ JSON
        production_stages = json_article_data.get('production_stages', {'Process': [], 'Finish': [], 'Wait': []})
        logger.info(f"  –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã –≤ JSON:")
        logger.info(f"    Process: {production_stages.get('Process', [])}")
        logger.info(f"    Finish: {production_stages.get('Finish', [])}")
        logger.info(f"    Wait: {production_stages.get('Wait', [])}")

        # –ò—â–µ–º —ç—Ç–∞–ø "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ" –≤ UI
        ui_production_stage = self._find_production_stage_in_ui(page_article_data)
        if not ui_production_stage:
            logger.info("  –í UI –Ω–µ—Ç —ç—Ç–∞–ø–∞ '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ' - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∞")
            return None

        logger.info(f"  –≠—Ç–∞–ø –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –≤ UI: {ui_production_stage}")

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–∂–∏–¥–∞–µ–º—ã–π —Ü–≤–µ—Ç –∏ —Ç–µ–∫—Å—Ç
        expected_color, expected_text = self._get_expected_production_display(production_stages, is_outsource)
        logger.info(f"  –û–∂–∏–¥–∞–µ–º—ã–π —Ü–≤–µ—Ç: {expected_color}")
        logger.info(f"  –û–∂–∏–¥–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç: {expected_text}")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ü–≤–µ—Ç–∞
        color_match = ui_production_stage['color'] == expected_color

        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        ui_text_normalized = self._normalize_stage_text(ui_production_stage['text'])
        expected_text_normalized = self._normalize_stage_text(expected_text)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (—É—á–∏—Ç—ã–≤–∞–µ–º —á—Ç–æ UI –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
        text_match = (expected_text_normalized in ui_text_normalized) or (ui_text_normalized == expected_text_normalized)

        logger.info(f"  –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞: {'‚úì' if color_match else '‚úó'}")
        logger.info(f"  –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞: {'‚úì' if text_match else '‚úó'}")
        logger.info(f"  UI —Ç–µ–∫—Å—Ç (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π): '{ui_text_normalized}'")
        logger.info(f"  –û–∂–∏–¥–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π): '{expected_text_normalized}'")

        if color_match and text_match:
            logger.info("  –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úì –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞")
            return None
        else:
            logger.warning("  –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úó –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –Ω–∞—Ä—É—à–µ–Ω–∞")
            return {
                'status_type': 'Production',
                'message': '–ù–∞—Ä—É—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
                'expected_color': expected_color,
                'actual_color': ui_production_stage['color'],
                'expected_text': expected_text,
                'actual_text': ui_production_stage['text'],
                'is_outsource': is_outsource,
                'production_stages': production_stages
            }

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏")
    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–ø–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏")
    def verify_delivery_popups_fast(self):
        """
        –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–ø–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–æ—Å—Ç–∞–≤–∫–µ.
        –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON, –∑–∞—Ç–µ–º –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç UI.
        """
        logger.info("–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–ø–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏")
        # 1. –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ JSON (–±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è)
        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ JSON"):
            json_delivery_info = self._get_delivery_info_from_json()
            json_delivery_count = len(json_delivery_info) if isinstance(json_delivery_info, list) else 0
            logger.debug(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –æ –¥–æ—Å—Ç–∞–≤–∫–µ –≤ JSON: {json_delivery_count}")

        # 2. –ï—Å–ª–∏ –≤ JSON –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º UI
        if json_delivery_count == 0:
            with allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã –≤ UI"):
                try:
                    # –ò—â–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ø–∞–ø—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ç–∞–π–º–∞—É—Ç–æ–º
                    delivery_links = self.find_elements(BTPServicePageLocators.DELIVERY_POPUP_LINKS, sec=1)
                    logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã –≤ UI: {len(delivery_links)}")

                    if not delivery_links:
                        logger.info("–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI - —Ç–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω")
                        return {
                            "success": True,
                            "skip_test": True,
                            "skip_reason": "–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI"
                        }
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã: {e}")
                    logger.info("–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI - —Ç–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω")
                    return {
                        "success": True,
                        "skip_test": True,
                        "skip_reason": "–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI"
                    }

        # 3. –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã –≤ UI
        with allure.step("–ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã –≤ UI"):
            timeout = 5 if json_delivery_count > 0 else 2
            logger.debug(f"–¢–∞–π–º–∞—É—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Å—ã–ª–æ–∫: {timeout} —Å–µ–∫—É–Ω–¥")

            try:
                delivery_links = self.find_elements(BTPServicePageLocators.DELIVERY_POPUP_LINKS, sec=timeout)
                ui_delivery_count = len(delivery_links)
                logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã –≤ UI: {ui_delivery_count}")
            except Exception as e:
                logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã: {e}")
                ui_delivery_count = 0

        # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
        count_match = json_delivery_count == ui_delivery_count
        logger.info(f"–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –æ –¥–æ—Å—Ç–∞–≤–∫–µ: {count_match}")

        # 5. –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if not count_match:
            logger.warning(
                f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç: –≤ JSON {json_delivery_count}, –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ {ui_delivery_count}")
            return {
                "success": False,
                "skip_test": False,
                "json_delivery_count": json_delivery_count,
                "ui_delivery_count": ui_delivery_count,
                "count_match": False,
                "message": (f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç: " +
                            f"–≤ JSON {json_delivery_count}, –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ {ui_delivery_count}")
            }

        # 6. –ï—Å–ª–∏ –Ω–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if ui_delivery_count == 0:
            logger.info("–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI - —Ç–µ—Å—Ç –ø—Ä–æ–ø—É—â–µ–Ω")
            return {
                "success": True,
                "skip_test": True,
                "skip_reason": "–ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ UI",
                "count_match": True
            }

        # 7. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ø–∞–ø—ã, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        with allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–ø–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏"):
            processed_count = 0

            # 8. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ø–∞–ø
            for i in range(min(ui_delivery_count, 3)):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –±–æ–ª–µ–µ 3 –ø–æ–ø–∞–ø–æ–≤
                try:
                    # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å—Å—ã–ª–∫–∏ –∑–∞–Ω–æ–≤–æ (–æ–Ω–∏ –º–æ–≥–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞)
                    delivery_links = self.find_elements(BTPServicePageLocators.DELIVERY_POPUP_LINKS, sec=2)
                    logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã: {len(delivery_links)}")

                    if i >= len(delivery_links):
                        logger.warning(f"–ù–µ –Ω–∞–π–¥–µ–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–ø–∞–ø—ã, –ø—Ä–æ–ø—É—Å–∫ –ø–æ–ø–∞–ø–∞ #{i + 1}")
                        break

                    # –ü–æ–ª—É—á–∞–µ–º ID —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ø–∞–ø–∞
                    popup_target = delivery_links[i].get_attribute("data-bs-target")
                    popup_id = popup_target.replace("#", "")
                    logger.debug(f"ID –ø–æ–ø–∞–ø–∞ #{i + 1}: {popup_id}")

                    # –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
                    logger.debug(f"–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å—Å—ã–ª–∫—É –ø–æ–ø–∞–ø–∞ #{i + 1}")
                    delivery_links[i].click()

                    # –ñ–¥–µ–º –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ç–∞–π–º–∞—É—Ç–æ–º
                    logger.debug(f"–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ #{i + 1}...")
                    wait = WebDriverWait(self.driver, 3)
                    wait.until(
                        EC.visibility_of_element_located((By.ID, popup_id))
                    )
                    logger.info(f"–ü–æ–ø–∞–ø #{i + 1} —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç")

                    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
                    logger.debug(f"–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ #{i + 1}")
                    close_button = self.driver.find_element(By.CSS_SELECTOR, f"#{popup_id} button.btn-close")
                    close_button.click()

                    # –ñ–¥–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞
                    logger.debug(f"–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ #{i + 1}...")
                    wait.until(
                        EC.invisibility_of_element_located((By.ID, popup_id))
                    )
                    logger.info(f"–ü–æ–ø–∞–ø #{i + 1} —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã—Ç")

                    processed_count += 1

                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–ø–∞–ø–∞ #{i + 1}: {e}")

            logger.info(f"–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–ø–∞–ø–æ–≤: {processed_count} –∏–∑ {ui_delivery_count}")

        # 9. –†–µ–∑—É–ª—å—Ç–∞—Ç
        result = {
            "success": processed_count > 0,
            "json_delivery_count": json_delivery_count,
            "ui_delivery_count": ui_delivery_count,
            "processed_count": processed_count,
            "count_match": count_match,
            "all_popups_processed": processed_count == ui_delivery_count,
            "skip_test": False
        }

        logger.info(f"–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ø–∞–ø–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏: {'‚úì' if result['success'] else '‚úó'}")
        return result

    def _get_page_delivery_numbers(self, timeout=3):
        """
        –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "(–≤ —Ä–∞–±–æ—Ç–µ)"
        –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä timeout –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
        """
        logger.debug(f"–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Ç–∞–π–º–∞—É—Ç: {timeout})")
        page_delivery_numbers = {}

        try:
            # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ç–∞–π–º–∞—É—Ç–æ–º
            article_elements = self.find_elements(
                BTPServicePageLocators.ARTICLE_ACCORDION_ITEMS,
                timeout
            )
            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(article_elements)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")

            for element in article_elements:
                try:
                    # –ò—â–µ–º –Ω–æ–º–µ—Ä –∞—Ä—Ç–∏–∫—É–ª–∞
                    article_element = element.find_element(*BTPServicePageLocators.ARTICLE_HEADERS)
                    article = article_element.text.strip()
                    if not article:
                        continue

                    # –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å –Ω–æ–º–µ—Ä–æ–º –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏
                    delivery_elements = element.find_elements(*BTPServicePageLocators.DELIVERY_NUMBER)

                    delivery_number = None
                    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                    for delivery_elem in delivery_elements:
                        text = delivery_elem.text.strip()
                        if "‚Ññ" in text:
                            parts = text.split("‚Ññ", 1)
                            if len(parts) > 1:
                                delivery_number = parts[1].strip()
                                logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω –Ω–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {delivery_number}")
                                break

                    # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ª–æ–≤–∞—Ä—å
                    page_delivery_numbers[article] = delivery_number

                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞—Ä—Ç–∏–∫—É–ª–∞ –¥–ª—è –Ω–æ–º–µ—Ä–∞ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {e}")
                    continue

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {e}")
            # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å—Ç–µ–∫ —Ç–∞–π–º–∞—É—Ç) –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å
            return {}

        return page_delivery_numbers

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞")
    def verify_order_number(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"""
        logger.info("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞")
        if not self.order_number:
            logger.error("–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            raise ValueError("–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
            page_order_number = self.get_order_number()
            logger.info(f"–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {page_order_number}")
            logger.info(f"–û–∂–∏–¥–∞–µ–º—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: {self.order_number}")

        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –∑–∞–∫–∞–∑–∞"):
            match = page_order_number == self.order_number
            logger.info(f"–ù–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç: {match}")

        return match, {
            'page': page_order_number,
            'expected': self.order_number
        }

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞")
    def verify_order_status(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –≤ JSON"""
        logger.info("–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞")
        if not self.json_handler:
            logger.error("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            raise ValueError("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
            page_statuses = self.get_order_status()
            logger.info(f"–°—Ç–∞—Ç—É—Å—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {page_statuses}")

        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞ –∏–∑ JSON"):
            json_statuses = self.json_handler.get_order_statuses()
            logger.info(f"–°—Ç–∞—Ç—É—Å—ã –≤ JSON: {json_statuses}")

        # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã
        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤"):
            status_match = set(page_statuses) == set(json_statuses)
            logger.info(f"–°—Ç–∞—Ç—É—Å—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç: {status_match}")

        return status_match, {
            'page': page_statuses,
            'json': json_statuses
        }

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")
    def verify_articles(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –≤ JSON"""
        logger.info("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")
        if not self.json_handler:
            logger.error("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            raise ValueError("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
            page_articles = self.get_articles()
            logger.info(f"–ê—Ä—Ç–∏–∫—É–ª—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {page_articles}")

        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ JSON"):
            json_articles = self.json_handler.get_articles()
            logger.info(f"–ê—Ä—Ç–∏–∫—É–ª—ã –≤ JSON: {json_articles}")

        # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∞—Ä—Ç–∏–∫—É–ª—ã
        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–æ–≤"):
            articles_match = set(page_articles) == set(json_articles)
            logger.info(f"–ê—Ä—Ç–∏–∫—É–ª—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç: {articles_match}")

        return articles_match, {
            'page': page_articles,
            'json': json_articles
        }

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤")
    def verify_material_numbers(self):
        """
        –ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–º–µ—Ä–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏.
        """
        logger.info("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏")

        # –®–∞–≥ 1: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON
        with allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ' –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON"):
            try:
                # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
                original_implicit_wait = self.driver.timeouts.implicit_wait
                self.driver.implicitly_wait(1)

                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ "–ø–æ–¥—Ä–æ–±–Ω–µ–µ"
                try:
                    details_buttons = self.driver.find_elements(By.XPATH,
                                                                "//span[contains(@class, 'cursor-pointer') and contains(@class, 'text-danger') and contains(text(), '–ø–æ–¥—Ä–æ–±–Ω–µ–µ')]")
                    has_button = len(details_buttons) > 0
                    logger.debug(f"–ù–∞–π–¥–µ–Ω–æ –∫–Ω–æ–ø–æ–∫ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ': {len(details_buttons)}")
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–Ω–æ–ø–æ–∫ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ': {e}")
                    has_button = False
                    details_buttons = []

                # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è
                self.driver.implicitly_wait(original_implicit_wait)

            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ': {e}")
                return False, {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ': {str(e)}"}

            # –ü–æ–ª—É—á–∞–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–∑ JSON
            try:
                json_materials = self._get_materials_from_json()
                has_json_materials = any(materials for materials in json_materials.values())
                logger.debug(f"–ê—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –≤ JSON: {len(json_materials)}")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON: {e}")
                return False, {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON: {str(e)}"}

            # –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
            if not has_button and not has_json_materials:
                logger.info("–ù–∏ –∫–Ω–æ–ø–∫–∏, –Ω–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - —Ç–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω")
                return True, {"message": "–ù–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ' –∏ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON"}

            if not has_button and has_json_materials:
                logger.warning("–û—à–∏–±–∫–∞: –Ω–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ JSON")
                return False, {"message": "–ù–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ JSON"}

            if has_button and not has_json_materials:
                logger.warning("–û—à–∏–±–∫–∞: –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON")
                return False, {"message": "–ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON"}

        # –®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
        with allure.step("–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏"):
            popup = self._open_details_popup(details_buttons)
            if not popup:
                logger.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏")
                return False, {"error": "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏"}

        # –®–∞–≥ 3: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –≤ –ø–æ–ø–∞–ø–µ
        with allure.step("–°–±–æ—Ä –∫–æ–¥–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ø–æ–ø–∞–ø–∞"):
            try:
                ui_materials = self._collect_material_codes_from_popup(popup)
                if not ui_materials:
                    logger.warning("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–∑ –ø–æ–ø–∞–ø–∞")
                    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ø–æ–ø–∞–ø–∞: {e}")
                # –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ—à–∏–±–∫–∏
                self._close_popup()
                return False, {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ø–æ–ø–∞–ø–∞: {str(e)}"}

        # –®–∞–≥ 4: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞
        with allure.step("–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞"):
            if not self._close_popup():
                logger.warning("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
                # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞

        # –®–∞–≥ 5: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ UI –∏ JSON
        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ UI –∏ JSON"):
            try:
                results = self._compare_materials(json_materials, ui_materials)
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {e}")
                return False, {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {str(e)}"}

        # –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        all_match = all(r["match"] for r in results)
        logger.info(f"–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–º–µ—Ä–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {'‚úì' if all_match else '‚úó'}")

        return all_match, results

    def _check_details_button_and_json(self):
        """
        –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ "–ø–æ–¥—Ä–æ–±–Ω–µ–µ" –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON.
        """
        logger.info("–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ' –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON")

        # –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º –∏–º–ø–ª–∏—Ü–∏—Ç–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ
        original_implicit_wait = self.driver.timeouts.implicit_wait
        self.driver.implicitly_wait(1)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ

        try:
            # –ò—â–µ–º –∫–Ω–æ–ø–∫—É "–ø–æ–¥—Ä–æ–±–Ω–µ–µ"
            details_buttons = self.find_elements((By.XPATH,
                                                "//span[contains(@class, 'cursor-pointer') and contains(@class, 'text-danger') and contains(text(), '–ø–æ–¥—Ä–æ–±–Ω–µ–µ')]"),
                                               sec=1)
            has_button = len(details_buttons) > 0
            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ –∫–Ω–æ–ø–æ–∫ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ': {len(details_buttons)}")
        finally:
            # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º–ø–ª–∏—Ü–∏—Ç–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ
            self.driver.implicitly_wait(original_implicit_wait)

        # –ü–æ–ª—É—á–∞–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–∑ JSON
        json_materials = self._get_materials_from_json()
        has_json_materials = any(materials for materials in json_materials.values())
        logger.debug(f"–ê—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –≤ JSON: {len(json_materials)}")

        # –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ
        if not has_button and not has_json_materials:
            logger.info("–ù–∏ –∫–Ω–æ–ø–∫–∏, –Ω–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - —Ç–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω")
            return True, {"message": "–ù–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ' –∏ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON"}

        if not has_button and has_json_materials:
            logger.warning("–û—à–∏–±–∫–∞: –Ω–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ JSON")
            return False, {"message": "–ù–µ—Ç –∫–Ω–æ–ø–∫–∏ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ JSON"}

        if has_button and not has_json_materials:
            logger.warning("–û—à–∏–±–∫–∞: –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON")
            return False, {"message": "–ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ', –Ω–æ –Ω–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –≤ JSON"}

        return True, {"details_buttons": details_buttons, "json_materials": json_materials}

    def _get_materials_from_json(self):
        """
        –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–º–µ—Ä–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤.
        """
        logger.debug("–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON")
        materials_by_article = {}

        for item in self.json_handler.get_order_items():
            article = item.get('materialCode')
            if not article:
                continue

            materials_by_article[article] = []

            internal_order = item.get('internalOrder')
            if not internal_order:
                continue

            for material in internal_order.get('items', []):
                material_code = material.get('materialCode')
                if material_code:
                    materials_by_article[article].append(material_code)
                    logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω –º–∞—Ç–µ—Ä–∏–∞–ª: {material_code}")

        return materials_by_article

    def _open_details_popup(self, details_buttons=None):
        """
        –®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.
        """
        logger.info("–®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏")

        try:
            # –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã, –∏—â–µ–º –∏—Ö —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º —Ç–∞–π–º–∞—É—Ç–æ–º
            if details_buttons is None or len(details_buttons) == 0:
                details_buttons = self.find_elements(BTPServicePageLocators.DETAILS_POPUP_BUTTON, sec=20)

            if not details_buttons or len(details_buttons) == 0:
                logger.error("–û—à–∏–±–∫–∞: –∫–Ω–æ–ø–∫–∞ '–ø–æ–¥—Ä–æ–±–Ω–µ–µ' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                return None

            # # –°–∫—Ä–æ–ª–ª–∏–º –∫ –∫–Ω–æ–ø–∫–µ –∏ –¥–µ–ª–∞–µ–º –ø–∞—É–∑—É –ø–æ—Å–ª–µ —Å–∫—Ä–æ–ª–ª–∞
            # self.scroll_to(details_buttons[0])
            # time.sleep(1)  # –î–∞–µ–º –≤—Ä–µ–º—è —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ —Å–∫—Ä–æ–ª–ª–∞

            # –ñ–¥–µ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º —Ç–∞–π–º–∞—É—Ç–æ–º (30 —Å–µ–∫—É–Ω–¥)
            logger.debug("–û–∂–∏–¥–∞–Ω–∏–µ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–Ω–æ–ø–∫–∏ (–¥–æ 30 —Å–µ–∫—É–Ω–¥)...")
            self.expecting_clickability(BTPServicePageLocators.DETAILS_POPUP_BUTTON, sec=30)

            # # –ü–æ–≤—Ç–æ—Ä–Ω—ã–π —Å–∫—Ä–æ–ª–ª –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –æ–∂–∏–¥–∞–Ω–∏—è
            # self.scroll_to(details_buttons[0])
            # time.sleep(0.5)

            # –ö–ª–∏–∫
            logger.debug("–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É")
            details_buttons[0].click()

            # –ñ–¥–µ–º –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ (40 —Å–µ–∫—É–Ω–¥)
            logger.debug("–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞ (–¥–æ 40 —Å–µ–∫—É–Ω–¥)...")
            self.waiting_element_is_visibility_on_the_page(BTPServicePageLocators.MODAL_DIALOG, sec=40)

            # –ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞—É–∑–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ø–∞–ø–∞
            time.sleep(1)

            # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ø–∞–ø
            popup = self.find_element(BTPServicePageLocators.MODAL_DIALOG)
            logger.info("–ü–æ–ø–∞–ø —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç")

            return popup

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞: {e}")
            return None

    def _collect_material_codes_from_popup(self, popup):
        """
        –®–∞–≥ 3: –°–±–æ—Ä –∫–æ–¥–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ø–æ–ø–∞–ø–∞.
        """
        import re
        logger.info("–®–∞–≥ 3: –°–±–æ—Ä –∫–æ–¥–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ø–æ–ø–∞–ø–∞")

        ui_materials = {}

        try:
            # –ù–∞—Ö–æ–¥–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞–º–∏ –≤ –ø–æ–ø–∞–ø–µ –ø–æ ID
            try:
                accordion_container = popup.find_element(By.ID, "service-btp-items-detail")
                logger.debug("–ù–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –ø–æ ID")
            except:
                # –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - –ø–æ–∏—Å–∫ –ø–æ –∫–ª–∞—Å—Å—É
                accordion_container = popup.find_element(By.CSS_SELECTOR, "div.accordion.mt-4")
                logger.debug("–ù–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –ø–æ –∫–ª–∞—Å—Å—É")

            # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            accordion_items = accordion_container.find_elements(By.CSS_SELECTOR, "div.accordion-item")
            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤ –≤ –ø–æ–ø–∞–ø–µ: {len(accordion_items)}")

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã–π –∞–∫–∫–æ—Ä–¥–µ–æ–Ω –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
            open_accordion = popup.find_elements(By.CSS_SELECTOR, "div.accordion-collapse.show")
            initially_open = len(open_accordion) > 0
            logger.debug(f"–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç –∞–∫–∫–æ—Ä–¥–µ–æ–Ω: {initially_open}")

            # –ï—Å–ª–∏ –Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π
            if not initially_open and accordion_items:
                first_button = accordion_items[0].find_element(By.CSS_SELECTOR, "div.accordion-button")
                logger.debug("–û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –∞–∫–∫–æ—Ä–¥–µ–æ–Ω")
                self.scroll_to(first_button)
                time.sleep(0.5)  # –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –∫–ª–∏–∫–æ–º
                first_button.click()
                time.sleep(1)  # –ü–∞—É–∑–∞ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞

            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –∞–∫–∫–æ—Ä–¥–µ–æ–Ω
            for i, item in enumerate(accordion_items):
                try:
                    # –ü–æ–ª—É—á–∞–µ–º –∞—Ä—Ç–∏–∫—É–ª
                    article_header = item.find_element(By.CSS_SELECTOR, "div.fs-4.fw-bold")
                    article = article_header.text.strip()

                    if not article:
                        logger.warning(f"–ê–∫–∫–æ—Ä–¥–µ–æ–Ω {i + 1}: –∞—Ä—Ç–∏–∫—É–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                        continue

                    logger.debug(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ {i + 1}: {article}")

                    # –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                    accordion_button = item.find_element(By.CSS_SELECTOR, "div.accordion-button")

                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç –ª–∏ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω
                    is_expanded = accordion_button.get_attribute("aria-expanded") == "true"
                    logger.debug(f"–ê–∫–∫–æ—Ä–¥–µ–æ–Ω {article} –æ—Ç–∫—Ä—ã—Ç: {is_expanded}")

                    # –ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã—Ç - –æ—Ç–∫—Ä—ã–≤–∞–µ–º
                    if not is_expanded:
                        # –°–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º –∫ –∫–Ω–æ–ø–∫–µ
                        self.scroll_to(accordion_button)
                        time.sleep(0.5)  # –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –∫–ª–∏–∫–æ–º

                        # –ö–ª–∏–∫
                        logger.debug(f"–û—Ç–∫—Ä—ã–≤–∞–µ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω {article}")
                        accordion_button.click()

                        # –ñ–¥–µ–º –æ—Ç–∫—Ä—ã—Ç–∏—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                        logger.debug("–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞...")
                        wait = WebDriverWait(self.driver, 10)
                        wait.until(
                            EC.presence_of_element_located((By.CSS_SELECTOR, "div.accordion-collapse.show"))
                        )

                        # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
                        time.sleep(1)

                    # –ù–∞—Ö–æ–¥–∏–º –æ—Ç–∫—Ä—ã—Ç—ã–π —Ä–∞–∑–¥–µ–ª –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                    accordion_body = None
                    try:
                        # –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω –ø–æ ID
                        accordion_bodies = popup.find_elements(By.CSS_SELECTOR, "div.accordion-collapse.show")
                        if accordion_bodies:
                            accordion_body = accordion_bodies[0]
                            logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")
                        else:
                            logger.warning(f"–û—à–∏–±–∫–∞: –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")
                            continue
                    except Exception as e:
                        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞: {e}")
                        continue

                    # –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
                    material_elements = accordion_body.find_elements(By.CSS_SELECTOR, "div.text-gray")
                    logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏: {len(material_elements)}")

                    # –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
                    for j, elem in enumerate(material_elements):
                        text = elem.text.strip()
                        logger.debug(f"–ú–∞—Ç–µ—Ä–∏–∞–ª {j + 1}: '{text}'")

                    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–¥—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
                    material_codes = []
                    for elem in material_elements:
                        text = elem.text.strip()
                        if text:
                            # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–¥ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –º–µ–∂–¥—É –Ω–æ–º–µ—Ä–æ–º –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π
                            match = re.search(r'\d+\.\s+([\w-]+)\s*\|', text)
                            if match:
                                material_code = match.group(1).strip()  # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
                                material_codes.append(material_code)
                                logger.debug(f"–ò–∑–≤–ª–µ—á–µ–Ω –∫–æ–¥: {material_code}")

                    ui_materials[article] = material_codes
                    logger.debug(f"–°–æ–±—Ä–∞–Ω–æ –∫–æ–¥–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {len(material_codes)}")

                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ {i + 1}: {e}")

        except Exception as e:
            logger.error(f"–û–±—â–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {e}")

        return ui_materials

    def _close_popup(self):
        """
        –®–∞–≥ 4: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞.
        """
        logger.info("–®–∞–≥ 4: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞")

        try:
            # –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è
            close_button = self.find_element((By.CSS_SELECTOR, "button.btn-close"))
            logger.debug("–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞")
            close_button.click()

            # –ñ–¥–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞
            wait = WebDriverWait(self.driver, 10)
            wait.until(
                EC.invisibility_of_element_located((By.CSS_SELECTOR, "div.modal-dialog.modal-dialog-centered"))
            )
            logger.info("–ü–æ–ø–∞–ø —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã—Ç")
            return True

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞ –∫–Ω–æ–ø–∫–æ–π: {e}")

            # –ü—Ä–æ–±—É–µ–º –∑–∞–∫—Ä—ã—Ç—å –∫–ª–∞–≤–∏—à–µ–π ESC
            try:
                logger.debug("–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø –∫–ª–∞–≤–∏—à–µ–π ESC")
                body = self.find_element((By.TAG_NAME, "body"))
                body.send_keys(Keys.ESCAPE)

                wait = WebDriverWait(self.driver, 10)
                wait.until(
                    EC.invisibility_of_element_located((By.CSS_SELECTOR, "div.modal-dialog.modal-dialog-centered"))
                )
                logger.info("–ü–æ–ø–∞–ø —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã—Ç –∫–ª–∞–≤–∏—à–µ–π ESC")
                return True

            except Exception as e2:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞ –∫–ª–∞–≤–∏—à–µ–π ESC: {e2}")
                return False

    def _compare_materials(self, json_materials, ui_materials):
        """
        –®–∞–≥ 5: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON –∏ UI.
        """
        logger.info("–®–∞–≥ 5: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON –∏ UI")

        results = []

        # –í—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã
        all_articles = set(list(json_materials.keys()) + list(ui_materials.keys()))

        for article in all_articles:
            json_codes = sorted(json_materials.get(article, []))
            ui_codes = sorted(ui_materials.get(article, []))

            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
            match = json_codes == ui_codes

            # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            result = {
                "article": article,
                "match": match,
                "json_materials": json_codes,
                "ui_materials": ui_codes
            }

            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è, –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
            if not match:
                only_in_json = set(json_codes) - set(ui_codes)
                only_in_ui = set(ui_codes) - set(json_codes)

                if only_in_json:
                    result["only_in_json"] = list(only_in_json)

                if only_in_ui:
                    result["only_in_ui"] = list(only_in_ui)

            results.append(result)
            logger.debug(f"–ê—Ä—Ç–∏–∫—É–ª {article}: —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = {match}")

        return results

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")
    def verify_statuses_simplest(self):
        """
        –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏–π.
        –°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º,
        –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ JSON.
        """
        logger.info("–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")

        # 1. –°–æ–±–∏—Ä–∞–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ UI
        with allure.step("–°–±–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ UI"):
            ui_statuses = self._collect_ui_statuses()
            logger.debug(f"–°–æ–±—Ä–∞–Ω–æ {len(ui_statuses)} —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ UI")

        # 2. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON
        with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ JSON"):
            json_statuses = self._collect_json_statuses()
            logger.debug(f"–°–æ–±—Ä–∞–Ω–æ {len(json_statuses)} —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ JSON")

        # 3. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ UI –∏ JSON"):
            results = self._compare_statuses(ui_statuses, json_statuses)

        # 4. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        all_match = all(r["match"] for r in results)
        logger.info(f"–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤: {'‚úì' if all_match else '‚úó'}")

        return all_match, results

    def _collect_ui_statuses(self):
    """
    –°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ UI.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å: {–∞—Ä—Ç–∏–∫—É–ª: {"indicator": –∫–ª–∞—Å—Å_–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, "text": —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç—É—Å–∞}}
    """
    logger.debug("–°–±–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ UI")
    result = {}

    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∞—Ä—Ç–∏–∫—É–ª—ã —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
        elements = self.find_elements((By.CSS_SELECTOR, "div.accordion-item"))
        logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(elements)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞")

        for element in elements:
            try:
                # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –∞—Ä—Ç–∏–∫—É–ª–∞
                article_element = element.find_element(By.CSS_SELECTOR, "div.fs-4.fw-bold")
                article = article_element.text.strip()

                # –ò—â–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞
                indicator = None
                status_text = None

                # –ü–æ–∏—Å–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
                indicators = element.find_elements(By.CSS_SELECTOR,
                                                   "div.accordion-header i.service-btp_icon--blue, " +
                                                   "div.accordion-header i.service-btp_icon--green, " +
                                                   "div.accordion-header i.service-btp_icon--gray, " +
                                                   "div.accordion-header i[class*='blue'], " +
                                                   "div.accordion-header i[class*='green'], " +
                                                   "div.accordion-header i[class*='gray']")

                if indicators:
                    # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    indicator_element = indicators[0]
                    indicator_class = indicator_element.get_attribute("class")
                    logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: {indicator_class}")

                    # –ù–∞—Ö–æ–¥–∏–º —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞ (—Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç div –ø–æ—Å–ª–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)
                    parent = indicator_element.find_element(By.XPATH, "./..")
                    text_elements = parent.find_elements(By.CSS_SELECTOR, "div.fs-5, div.fw-bold")

                    if text_elements:
                        status_text = text_elements[0].text.strip()
                        logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞: {status_text}")

                # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                if article:
                    result[article] = {
                        "indicator": indicator_class,
                        "text": status_text
                    }

            except Exception as e:
                logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞—Ä—Ç–∏–∫—É–ª–∞: {e}")
                continue

    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ UI: {e}")

    return result

    def _collect_json_statuses(self):
    """
    –°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ JSON.
    –õ–æ–≥–∏–∫–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º UI:
    - –ï—Å–ª–∏ –µ—Å—Ç—å internalOrder ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–î–æ–ø–æ—Å—Ç–∞–≤–∫–∞ ‚Ññ{–Ω–æ–º–µ—Ä}"
    - –ï—Å–ª–∏ –µ—Å—Ç—å Process ‚Üí –±–µ—Ä–µ–º –ü–ï–†–í–´–ô Process
    - –ï—Å–ª–∏ –Ω–µ—Ç Process ‚Üí –±–µ—Ä–µ–º –ü–û–°–õ–ï–î–ù–ò–ô Finish
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å: {–∞—Ä—Ç–∏–∫—É–ª: {"status": —Ç–∏–ø_—Å—Ç–∞—Ç—É—Å–∞, "text": —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç—É—Å–∞}}
    """
    logger.debug("–°–±–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ JSON")
    result = {}

    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–∞
    items = self.json_handler.get_order_items()
    logger.debug(f"–ü–æ–ª—É—á–µ–Ω–æ {len(items)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞–∫–∞–∑–∞ –∏–∑ JSON")

    for item in items:
        article = item.get("materialCode")
        if not article:
            continue

        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ internalOrder
        internal_order = item.get("internalOrder")
        if internal_order and internal_order.get("internalRequestOrderNumber"):
            # –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            delivery_number = internal_order.get("internalRequestOrderNumber")
            result[article] = {
                "status": "Process",  # –î–æ–ø–æ—Å—Ç–∞–≤–∫–∞ –≤—Å–µ–≥–¥–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ Process
                "text": f"–î–æ–ø–æ—Å—Ç–∞–≤–∫–∞ ‚Ññ{delivery_number}"
            }
            logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω –Ω–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {delivery_number}")
            continue

        # –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ª–æ–≥–∏–∫—É
        # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã Process –∏ Finish
        process_statuses = []
        finish_statuses = []

        for step in item.get("progressSteps", []):
            status = step.get("status")
            description = step.get("description", "")

            if status == "Process":
                process_statuses.append({"status": "Process", "text": description})
                logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω —Å—Ç–∞—Ç—É—Å Process: {description}")
            elif status == "Finish":
                finish_statuses.append({"status": "Finish", "text": description})
                logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω —Å—Ç–∞—Ç—É—Å Finish: {description}")

        # –ü—Ä–∏–º–µ–Ω—è–µ–º –ª–æ–≥–∏–∫—É –≤—ã–±–æ—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞
        if process_statuses:
            # –ï—Å–ª–∏ –µ—Å—Ç—å Process - –±–µ—Ä–µ–º –ü–ï–†–í–´–ô
            result[article] = process_statuses[0]
            logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –≤—ã–±—Ä–∞–Ω –ø–µ—Ä–≤—ã–π Process: {process_statuses[0]['text']}")
        elif finish_statuses:
            # –ï—Å–ª–∏ –Ω–µ—Ç Process - –±–µ—Ä–µ–º –ü–û–°–õ–ï–î–ù–ò–ô Finish
            result[article] = finish_statuses[-1]
            logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –≤—ã–±—Ä–∞–Ω –ø–æ—Å–ª–µ–¥–Ω–∏–π Finish: {finish_statuses[-1]['text']}")
        else:
            result[article] = {"status": None, "text": None}
            logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤")

    return result

   def _compare_statuses(self, ui_statuses, json_statuses):
    """
    –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ UI –∏ JSON.
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ —Ç–∏–ø—ã —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.
    """
    logger.info("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ UI –∏ JSON")
    results = []

    # –í—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã
    all_articles = set(list(ui_statuses.keys()) + list(json_statuses.keys()))
    logger.debug(f"–í—Å–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: {len(all_articles)}")

    for article in all_articles:
        ui_info = ui_statuses.get(article, {"indicator": None, "text": None})
        json_info = json_statuses.get(article, {"status": None, "text": None})

        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ —Ç–∏–ø —Å—Ç–∞—Ç—É—Å–∞
        ui_status = self._convert_indicator_to_status(ui_info.get("indicator"))

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞—Ç—É—Å–∞
        status_match = ui_status == json_info.get("status")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        text_match = True
        ui_text = ui_info.get("text")
        json_text = json_info.get("text")

        if ui_text and json_text:
            # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            ui_text_normalized = ui_text.lower()
            json_text_normalized = json_text.lower()
            
            # –£–±–∏—Ä–∞–µ–º "(–≤ —Ä–∞–±–æ—Ç–µ)" –∏–∑ UI —Ç–µ–∫—Å—Ç–∞
            ui_text_normalized = ui_text_normalized.replace("(–≤ —Ä–∞–±–æ—Ç–µ)", "").strip()
            
            # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏
            if "–¥–æ–ø–æ—Å—Ç–∞–≤–∫–∞ ‚Ññ" in ui_text_normalized and "–¥–æ–ø–æ—Å—Ç–∞–≤–∫–∞ ‚Ññ" in json_text_normalized:
                # –î–ª—è –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä–∞
                text_match = ui_text_normalized == json_text_normalized
            else:
                # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª—É—á–∞–π —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ."
                if ui_text_normalized.startswith("–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ."):
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∞—Å—Ç—å –ø–æ—Å–ª–µ "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ."
                    ui_text_normalized = ui_text_normalized.replace("–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.", "").strip()
                
                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
                text_match = (ui_text_normalized == json_text_normalized) or \
                           (ui_text_normalized in json_text_normalized) or \
                           (json_text_normalized in ui_text_normalized)
                       
            if not text_match:
                logger.warning(f"–ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article}:")
                logger.warning(f"  –í UI (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π): '{ui_text_normalized}'")
                logger.warning(f"  –í JSON (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π): '{json_text_normalized}'")

        # –ï—Å–ª–∏ –Ω–µ—Ç —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∏ –≤ UI, –Ω–∏ –≤ JSON - —ç—Ç–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        if not ui_status and not json_info.get("status"):
            status_match = True
            text_match = True

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        match = status_match and text_match
        results.append({
            "article": article,
            "match": match,
            "page_color": ui_status or "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç",
            "page_text": ui_text,
            "json_status": json_info.get("status"),
            "json_text": json_info.get("text"),
            "status_type_match": status_match,
            "text_match": text_match
        })

        logger.debug(f"–ê—Ä—Ç–∏–∫—É–ª {article}: —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = {match}")

    return results

       
    def _convert_indicator_to_status(self, indicator_class):
        """
        –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ —Ç–∏–ø —Å—Ç–∞—Ç—É—Å–∞.
        """
        if not indicator_class:
            return None

        indicator_class = indicator_class.lower()

        if "blue" in indicator_class:
            return "Process"
        elif "green" in indicator_class:
            return "Finish"
        elif "gray" in indicator_class:
            return "Wait"

        return None

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ç–æ")
    def verify_photo_buttons_simple(self):
        """
        –ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ç–æ.
        –°–æ–±–∏—Ä–∞–µ—Ç –¥–≤–∞ —Å–ø–∏—Å–∫–∞ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏—Ö.
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.
        """
        logger.info("–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ç–æ")
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        old_timeout = self.driver.timeouts.implicit_wait

        try:
            # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ (1 —Å–µ–∫—É–Ω–¥—ã) –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            self.driver.implicitly_wait(1)
            logger.debug("–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–µ—è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ: 1 —Å–µ–∫—É–Ω–¥–∞")

            # 1. –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ UI
            with allure.step("–°–±–æ—Ä –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ñ–æ—Ç–æ –∏–∑ UI"):
                ui_articles_with_photo = []

                # –ò—â–µ–º –≤—Å–µ –∞—Ä—Ç–∏–∫—É–ª—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ç–æ
                article_elements = self.find_elements((By.CSS_SELECTOR, "div.accordion.mt-4 div.fs-4.fw-bold"), sec=1)
                logger.debug(f"–ù–∞–π–¥–µ–Ω–æ {len(article_elements)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤")

                for article_elem in article_elements:
                    article = article_elem.text.strip()
                    if not article:
                        continue

                    # –ò—â–µ–º –∫–Ω–æ–ø–∫—É —Ñ–æ—Ç–æ –¥–ª—è —ç—Ç–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
                    try:
                        parent = article_elem.find_element(By.XPATH,
                                                           "./ancestor::div[contains(@class, 'accordion-item')]")
                        photo_buttons = parent.find_elements(By.XPATH, ".//button[contains(text(), '–§–æ—Ç–æ')]")

                        if photo_buttons:
                            ui_articles_with_photo.append(article)
                            logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ —Ñ–æ—Ç–æ")
                    except Exception as e:
                        logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–Ω–æ–ø–∫–∏ —Ñ–æ—Ç–æ –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article}: {e}")
                        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç, —Å—á–∏—Ç–∞–µ–º —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –Ω–µ—Ç
                        pass

                logger.info(f"–í—Å–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ñ–æ—Ç–æ –≤ UI: {len(ui_articles_with_photo)}")

            # 2. –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON
            with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å —Ñ–æ—Ç–æ –∏–∑ JSON"):
                json_articles_with_photo = []

                if self.json_handler and self.json_handler.json_data:
                    items = self.json_handler.json_data.get('objects', [{}])[0].get('items', [])
                    logger.debug(f"–ü–æ–ª—É—á–µ–Ω–æ {len(items)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞–∫–∞–∑–∞ –∏–∑ JSON")

                    for item in items:
                        article = item.get('materialCode')
                        if not article:
                            continue

                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–æ—Ç–æ
                        if 'images' in item and item['images']:
                            for image in item['images']:
                                if image.get('preview', {}).get('absoluteUrl'):
                                    json_articles_with_photo.append(article)
                                    logger.debug(f"–î–ª—è –∞—Ä—Ç–∏–∫—É–ª–∞ {article} –Ω–∞–π–¥–µ–Ω–æ —Ñ–æ—Ç–æ –≤ JSON")
                                    break

                logger.info(f"–í—Å–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å —Ñ–æ—Ç–æ –≤ JSON: {len(json_articles_with_photo)}")

            # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–∏—Å–∫–æ–≤
            with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å —Ñ–æ—Ç–æ"):
                match = set(ui_articles_with_photo) == set(json_articles_with_photo)
                logger.info(f"–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å —Ñ–æ—Ç–æ: {match}")

                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–ª–∏—á–∏—è—Ö
                only_in_ui = set(ui_articles_with_photo) - set(json_articles_with_photo)
                only_in_json = set(json_articles_with_photo) - set(ui_articles_with_photo)

                if only_in_ui:
                    logger.warning(f"–ê—Ä—Ç–∏–∫—É–ª—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ñ–æ—Ç–æ —Ç–æ–ª—å–∫–æ –≤ UI: {only_in_ui}")

                if only_in_json:
                    logger.warning(f"–ê—Ä—Ç–∏–∫—É–ª—ã —Å —Ñ–æ—Ç–æ —Ç–æ–ª—å–∫–æ –≤ JSON: {only_in_json}")

            # –ì–æ—Ç–æ–≤–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ—Ç—á–µ—Ç–∞
            result = {
                'match': match,
                'ui_articles': ui_articles_with_photo,
                'json_articles': json_articles_with_photo
            }

            return match, result

        finally:
            # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è
            self.driver.implicitly_wait(old_timeout)
            logger.debug(f"–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏—Å—Ö–æ–¥–Ω–æ–µ –Ω–µ—è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ: {old_timeout} —Å–µ–∫—É–Ω–¥")

    def get_photos_from_json(self):
        """
        –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–ª–∏—á–∏–∏ —Ñ–æ—Ç–æ –∏–∑ JSON –¥–∞–Ω–Ω—ã—Ö.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å {–∞—Ä—Ç–∏–∫—É–ª: –∏–º–µ–µ—Ç_—Ñ–æ—Ç–æ (True/False)}
        """
        logger.debug("–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞–ª–∏—á–∏–∏ —Ñ–æ—Ç–æ –∏–∑ JSON")
        if not self.json_handler:
            logger.warning("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            return {}

        # –î–µ–ª–µ–≥–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ json_handler
        result = self.json_handler.get_articles_with_photos()
        logger.debug(f"–ü–æ–ª—É—á–µ–Ω–æ {len(result)} –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–æ—Ç–æ")
        return result

    @allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏")
    def verify_delivery_numbers_fast(self):
        """
        –°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –±–µ–∑ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è.
        """
        logger.info("–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏")
        if not self.json_handler:
            logger.error("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            raise ValueError("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ implicit wait
        current_implicit_wait = self.driver.timeouts.implicit_wait

        try:
            # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–µ—è–≤–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
            self.driver.implicitly_wait(1)
            logger.debug("–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–µ—è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ: 1 —Å–µ–∫—É–Ω–¥–∞")

            # 1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º JSON (—ç—Ç–æ –±—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
            with allure.step("–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ JSON"):
                json_delivery_numbers = self.json_handler.get_delivery_numbers()
                has_json_deliveries = any(num is not None for num in json_delivery_numbers.values())
                logger.debug(
                    f"–ù–∞–π–¥–µ–Ω–æ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON: {sum(1 for num in json_delivery_numbers.values() if num is not None)}")

            # 2. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            with allure.step("–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"):
                try:
                    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ driver –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                    delivery_elements = self.driver.find_elements(*BTPServicePageLocators.DELIVERY_NUMBER_ELEMENT)
                    has_ui_deliveries = len(delivery_elements) > 0
                    logger.debug(f"–ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {len(delivery_elements)}")
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {e}")
                    has_ui_deliveries = False

            # 3. –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ–ø–æ—Å—Ç–∞–≤–æ–∫ –Ω–∏ –≤ JSON, –Ω–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ - —Ç–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω
            if not has_json_deliveries and not has_ui_deliveries:
                logger.info("–ù–µ—Ç –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ - —Ç–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω")
                return True, {"message": "–ù–µ—Ç –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"}

            # 4. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ - –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
            if has_json_deliveries and not has_ui_deliveries:
                logger.warning("–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ: –µ—Å—Ç—å –Ω–æ–º–µ—Ä–∞ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON, –Ω–æ –Ω–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ")
                return False, {"message": "–ï—Å—Ç—å –Ω–æ–º–µ—Ä–∞ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –≤ JSON, –Ω–æ –Ω–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"}

            if not has_json_deliveries and has_ui_deliveries:
                logger.warning("–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ: –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–æ –Ω–µ—Ç –≤ JSON")
                return False, {"message": "–ï—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–æ –Ω–µ—Ç –≤ JSON"}

            # 5. –ï—Å–ª–∏ –¥–æ—à–ª–∏ —Å—é–¥–∞, –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
            with allure.step("–°–±–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
                page_deliveries = self._get_page_delivery_numbers(timeout=3)

            # 6. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            with allure.step("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ JSON –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"):
                results = []
                all_articles = set(list(json_delivery_numbers.keys()) + list(page_deliveries.keys()))
                logger.debug(f"–í—Å–µ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: {len(all_articles)}")

                for article in all_articles:
                    json_delivery = json_delivery_numbers.get(article)
                    page_delivery_raw = page_deliveries.get(article)

                    # –û—á–∏—â–∞–µ–º –Ω–æ–º–µ—Ä –æ—Ç "(–≤ —Ä–∞–±–æ—Ç–µ)"
                    page_delivery_clean = None
                    if page_delivery_raw:
                        page_delivery_clean = page_delivery_raw.replace("(–≤ —Ä–∞–±–æ—Ç–µ)", "").strip()
                        if not page_delivery_clean:
                            page_delivery_clean = None

                    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
                    match = (json_delivery == page_delivery_clean)

                    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    result = {
                        'article': article,
                        'match': match,
                        'json_delivery': json_delivery,
                        'page_delivery_raw': page_delivery_raw,
                        'page_delivery_clean': page_delivery_clean
                    }

                    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
                    if json_delivery is None and page_delivery_clean is None:
                        result['message'] = "–ù–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ JSON –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
                    elif json_delivery is None:
                        result['message'] = "–ù–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –µ—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ JSON"
                    elif page_delivery_clean is None:
                        result['message'] = "–ù–æ–º–µ—Ä –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏ –µ—Å—Ç—å –≤ JSON, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
                    elif json_delivery != page_delivery_clean:
                        result[
                            'message'] = f"–ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤: –≤ JSON '{json_delivery}', –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ '{page_delivery_clean}'"

                    results.append(result)
                    logger.debug(f"–ê—Ä—Ç–∏–∫—É–ª {article}: —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = {match}")

                # –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                all_match = all(r['match'] for r in results)
                logger.info(f"–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–º–µ—Ä–æ–≤ –¥–æ–ø–æ—Å—Ç–∞–≤–∫–∏: {'‚úì' if all_match else '‚úó'}")
                return all_match, results

        finally:
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ implicit wait
            self.driver.implicitly_wait(current_implicit_wait)
            logger.debug(f"–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏—Å—Ö–æ–¥–Ω–æ–µ –Ω–µ—è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ: {current_implicit_wait} —Å–µ–∫—É–Ω–¥")

    def _get_delivery_info_from_json(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ JSON"""
        logger.debug("–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ JSON")
        if not self.json_handler or not self.json_handler.json_data:
            logger.warning("JSON –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã")
            return []

        try:
            order_object = self.json_handler.get_order_object()
            if not order_object:
                logger.warning("–û–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ JSON")
                return []

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–ª—é—á 'deliveryInfo'
            delivery_info = order_object.get('deliveryInfo')
            if delivery_info is None:
                logger.warning("–ö–ª—é—á 'deliveryInfo' –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –æ–±—ä–µ–∫—Ç–µ –∑–∞–∫–∞–∑–∞")
                return []

            logger.debug(f"–ü–æ–ª—É—á–µ–Ω–æ {len(delivery_info)} –∑–∞–ø–∏—Å–µ–π –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ JSON")
            return delivery_info
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑ JSON: {e}")
            return []
