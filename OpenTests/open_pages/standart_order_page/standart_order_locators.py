# Страница Стандартный заказ
from selenium.webdriver.common.by import By


class StandardOrderLocators:
    @staticmethod
    def dynamic_payment_terms_locator(terms_of_payment: str):
        """Динамический локатор Условий оплаты
        terms_of_payment - условия оплаты
        """
        locator_terms_of_payment = (
            By.XPATH,
            f"//div[text()='Условие оплаты']/following-sibling::div[contains(@class, 'single-select-box')]//span[text()='{terms_of_payment}']")
        return locator_terms_of_payment

    @staticmethod
    def locator_article_in_section_number(number_section: int):
        """
        Локатор Артикулы в секции по номеру секции
        :param number_section: Номер секции (сверху вниз) в разделе Оборудование в корзине
        :return: Локатор Артикулы в секции
        """
        locator_article_in_section_number = (
            By.XPATH,
            f"(//div[@data-order-create-materials-accordion])[{number_section}]//input[starts-with(@name, 'materials[') and contains(@name, '][code]')]"
        )
        return locator_article_in_section_number

    @staticmethod
    def locator_total_price_by_section(num_section: int):
        """
        Локатор Общая стоимость по номеру секции в разделе Оборудование в корзине
        :param num_section: Номер секции (сверху вниз)
        :return: Локатор Общая стоимость по номеру секции
        """
        locator_total_price_by_section = (
            By.XPATH,
            f"(//div[@id='accordion-order-create-equipment']//span[text()='Общая сумма заказа:']/following-sibling::span[@class='me-1'])[{num_section}]"
        )
        return locator_total_price_by_section

    @staticmethod
    def locator_wight_by_section(num_section: int):
        """
        Локатор Общий вес по номеру секции в разделе Оборудование в корзине
        :param num_section: Номер секции (сверху вниз) в разделе Оборудование в корзине
        :return: Локатор Общий вес по номеру секции
        """
        locator_wight_by_section = (
            By.XPATH,
            f"(//div[@id='accordion-order-create-equipment']//span[text()='Общий вес заказа:']/following-sibling::span[@class='me-1'])[{num_section}]"
        )
        return locator_wight_by_section

    LOCATOR_NO_LOADER = (By.CSS_SELECTOR, ".active.pe-4")
    LOCATOR_TAB_NEW_PROJECT = (
        By.XPATH, "//a[contains(text(), 'Новое проектное условие')]")  # Вкладка Новое проектное условие
    LOCATOR_TAB_KP_RIDAN = (By.XPATH, "//a[contains(text(), 'КП Ридан')]")  # Вклдака КП Ридан

    LOCATOR_TAB_STANDARD_ORDER = (By.XPATH, "//*[contains(text(), 'Стандартный заказ')]")  # Вкладка Стандартный заказ

    LOCATOR_H1 = (
        By.XPATH,
        "//div[@class='bg-light p-3 rounded']/span[text()='Формирование счета или резервация оборудования для покупки']"
    )

    LOCATOR_TOTAL_PRICE_CONFIRMATION = (
        By.XPATH,
        "//span[text()='Общая сумма заказа:']/following-sibling::span[1]")  # Стоимость на странице Подтверждение

    LOCATOR_COMMENT_FIELD = (By.XPATH, "//textarea[@name='comment']")  # Поле ввода комментария

    LOCATOR_TERMS_OF_PAYMENT = (By.XPATH, "//div[text()='Условие оплаты']/following::span[1]")  # Услвоия оплаты
    LOCATOR_SELECTED_PAYMENT_TERMS = (By.XPATH, "//div[text()='Условие оплаты']/following-sibling::div//span[text()]"
                                      )  # Выбранные условия оплаты

    LOCATOR_PREPAYMENT = (
        By.XPATH, "//ul[@data-id='-single-select-box']//span[text()='Предоплата']")  # условия оплаты- Предоплата

    LOCATOR_SHIPPING_LIST = (
        By.XPATH,
        "//div[contains(text(),'Выберите способ доставки')]")  # Способ доставки материалы выпадающий список

    LOCATOR_SHIPPING_LIST_PTO = (By.XPATH,
                                 "//div[contains(text(),'Выберите способ доставки Дзержинск')]"
                                 )  # Способ доставки ПТО выпадающий список (активация выпадающего списка)

    LOCATOR_LI_PICKUP_MATERIAL = (
        By.XPATH, "(//ul[@data-id='-single-select-box']//span[text()='Самовывоз'])[1]")  # Способ достаки - Самовывоз

    LOCATOR_UL_SHIPPING_LIST_PTO_ACTIVE = (
        By.XPATH,
        "//div[contains(text(), 'Выберите способ доставки Дзержинск')]/following-sibling::div[contains(@class, 'active')]/ul"
    )  # Активный (отображается на странице) список способа доставки ПТО

    LOCATOR_LI_PICKUP_PTO = (
        By.XPATH,
        "//div[contains(text(),'Выберите способ доставки Дзержинск')]/following::ul[@data-id='-single-select-box']/li//span[text()='Самовывоз']")
    # Способ достаки - Самовывоз ПТО

    LOCATOR_LI_PICKUP_PTO_TO_ADDRESS = (
        By.XPATH,
        "//div[contains(text(),'Выберите способ доставки Дзержинск')]/following::ul[@data-id='-single-select-box']/li//span[text()='Доставка на указанный адрес']")
    # Способ доставки Доставка на указанный адрес ПТО
    LOCATOR_LI_PICKUP_MATERIAL_TO_ADDRESS = (
        By.XPATH,
        "//div[text()='Выберите способ доставки' and @class='d-block w-100 fw-bold cursor-pointer']/parent::div//ul[@data-id='-single-select-box']//span[text()='Доставка на указанный адрес']"
    )  # Способ доставки у материалов в выпадающем списке - Доставка на указанный адрес

    LOCATOR_INPUT_LINE_ADDRESS_PTO = (By.XPATH, "//input[@name='delivery[dzerzhinsk][address][value]']"
                                      )  # Поле ввода адреса доставки ПТО
    LOCATOR_INPUT_ADDRESS_MOSCOW_TYPE_DELIVERY = (By.XPATH, "//input[@name='delivery[moscow][address][value]']"
                                                  )  # Поле ввода адреса доставки. Тип адрес доставки Москва
    LOCATOR_INPUT_DELIVERY_ADDRESS_MATERIAL = (By.XPATH, "//input[@name='delivery[address][value]']"
                                               )  # Поле ввода адреса доставки материалы
    LOCATOR_HEADER_DELIVERY_ADDRESS = (By.XPATH, "//span[contains(text(), 'Адрес доставки')]"
                                       )  # Заголовок Адрес доставки
    LOCATOR_ITEM_ADDRESS_IN_CHAPTER_DELIVERY_ADDRESS = (
        By.XPATH,
        "//span[normalize-space(text())='Адрес доставки']/following-sibling::div[@class='mb-2']//div[@data-dadata-type='address']//li"
    )  # Элемент в выпадающем списке выбора адреса в разделе Адрес доставки
    LOCATOR_CHOICE_ADDRESS_DZERZHINSK = (
        By.XPATH,
        "//span[normalize-space(text())='Адрес доставки Дзержинск']/following-sibling::div[@class='mb-2']//div[@data-dadata-type='address']//li"
    )  # Выбор адреса доставки Дзержинск

    LOCATOR_BTN_CALCULATE_COST_DELIVERY = (
        By.XPATH, "//span[text()=' Рассчитать стоимость доставки ']")  # Кнопка рассчитать стоимость доставки

    LOCATOR_COST_DELIVERY_PRODUCTION_DZERZHINSK = (
        By.XPATH,
        "//input[@name='delivery[costProductionDzerzhinsk]' or @name='delivery[dzerzhinsk][costProductionDzerzhinsk]']"
    )  # Рассчитанная стоимость доставки Продукция Дзержинск
    LOCATOR_COST_DELIVERY_DZERZHINSK = (By.XPATH, "//input[@name='delivery[dzerzhinsk][costDzerzhinsk]']"
                                        )  # Рассчитанная стоимость доставки Дзержинск
    LOCATOR_COST_DELIVERY_MATERIALS = (
        By.XPATH, "//input[@name='delivery[costMoscow]']")  # Рассчитанная стоимость доставки у материалов
    LOCATOR_INPUT_COST_MOSCOW_DELIVERY = (By.XPATH, "//input[@name='delivery[moscow][costMoscow]']"
                                          )  # Поле input стоимости доставки у типа доставки delivery moscow
    LOCATOR_INPUT_COST_PRODUCTION_MOSCOW = (By.XPATH, "//input[@name='delivery[moscow][costProductionMoscow]']"
                                            )  # Поле input стоимости доставки у типа доставки delivery costProductionMoscow
    LOCATOR_INPUT_DELIVERY_COST_PRODUCTION_DZERZHINSK = (By.XPATH, "//input[@name='delivery[costProductionDzerzhinsk]']"
                                                         )  # Инпут стоимости доставки delivery вида [costProductionDzerzhinsk]

    LOCATOR_TEXT_COST_DELIVERY = (
        By.XPATH, "//span[contains(text(), ' Рассчитать стоимость доставки ')]/parent::button[@disabled]"
    )  # Ожидание расчета стоимости доставки
    LOCATOR_BUTTON_CONFIRMATION = (By.XPATH, "//button[text()=' Подтвердить ']")  # Кнопка Подтвердить

    LOCATOR_PICKUP_ADDRESS_MATERIAL = (
        By.XPATH,
        "//div[contains(text(), 'Адрес склада')]/parent::div//span[text()][1]"
    )  # Адрес при самовывоза

    LOCATOR_PICKUP_ADDRESS_PTO = (
        By.XPATH,
        "//div[contains(text(), 'Адрес склада Дзержинск')]/parent::div//div[@class='overflow-hidden mw-100 text-truncate']/span[text()][1]"
    )  # Адрес склада при самовывоза ПТО
    LOCATOR_H3_PLACED_AN_ORDER = (By.XPATH, "//h3[text()='Размещен заказ']")  # Заголовок "Размещение заказа"

    LOCATOR_IS_WITH_COMPLETE_SET = (
        By.XPATH, "//input[@name='isWithACompleteSet']/../input[@type='checkbox']")  # Чек-бокс
    # "Отгрузка только при полной комплектации"
    LOCATOR_IS_WITH_COMPLETE_SET_NOT_EDITING = (
        By.XPATH, "//input[@class='form-check-input form-check-input__secondary' and @disabled]")  # Чек-бокс
    # "Отгрузка только при полной комплектации" не редактируется
    LOCATOR_IS_WITH_COMPLETE_SET_ON = (By.XPATH, "//input[@name='isWithACompleteSet' and @value='1'] ")  # Чек-бокс
    # "Отгрузка только при полной комплектации" - ВКЛЮЧЕН
    LOCATOR_IS_WITH_COMPLETE_SET_OFF = (By.XPATH, "//input[@name='isWithACompleteSet' and @value='0'] ")  # Чек-бокс
    # "Отгрузка только при полной комплектации" - ВЫКЛЮЧЕН
    LOCATOR_ALLOWANCES = (
        By.XPATH, "//div[@class='col-6 col-lg me-lg-0 mb-2 mb-lg-0' and contains(., '%')]"
    )  # Надбавка
    LOCATOR_INPUT_RADIO_BTN_TO_THE_DOOR_IN_DELIVERY_ADDRESS = (
        By.XPATH, "//span[normalize-space(text())='Адрес доставки']/parent::div//input[@value='to_the_door']"
    )  # Инпут в радио батоне До двери в разделе Адрес доставки
    LOCATOR_INPUT_RADIO_BTN_TO_THE_DOOR_IN_DELIVERY_ADDRESS_DZERZHINSK = (
        By.XPATH, "//span[normalize-space(text())='Адрес доставки Дзержинск']/parent::div//input[@value='to_the_door']"
    )  # Инпут в радио батоне До двери в разделе Адрес доставки Дзержинск
    LOCATOR_INPUT_INCLUDE_SHIPPING_IN_ORDER_PRICE_CHAPTER_DELIVERY_ADDRESS = (
        By.XPATH, "//input[@name='delivery[moscow][isCostIncludedInOrder]']/preceding-sibling::input"
    )  # Инпут Включить доставку в стоимость заказа в разделе Адрес доставки
    LOCATOR_INPUT_INCLUDE_SHIPPING_IN_ORDER_PRICE_CHAPTER_DELIVERY_ADDRESS_DZERZHINSK = (
        By.XPATH, "//input[@name='delivery[dzerzhinsk][isCostIncludedInOrder]']/preceding-sibling::input"
    )  # Инпут Включить доставку в стоимость заказа в разделе Адрес доставки Дзержинск
    LOCATOR_SECTIONS_BY_CODE_TYPES = (By.XPATH, "//div[@data-order-create-materials-accordion]"
                                      )  # Разделы по видам кодов в секции Оборудование в корзине
    LOCATOR_ARTICLE_CHAPTER_EQUIPMENT_IN_CART = (
        By.XPATH, "//input[starts-with(@name, 'materials[') and contains(@name, '][code]')]"
    )  # Артикулы в разделе Оборудование в корзине


class OrderSuccessPageLocators:
    """Страница успешного размещения заказа"""
    LOCATOR_NUM_PQ_IN_MODAL = (By.XPATH, "//a[@class='link-primary']")  # Локатор используется создается 1 заказ
    LOCATOR_BUTTON_DETAILS = (By.XPATH, "//a[contains(text(), 'Подробнее')]")

    # Локаторы для использования при создании двух заказов (Например компоненты + ПТО)
    LOCATOR_NUM_FIRST_PQ_IN_MODAL = (
        By.XPATH, "//div[@class='col-12 col-lg py-5']/div/div[1]//a")  # Локатор для первого заказа в списке
    LOCATOR_NUM_SECOND_PQ_IN_MODAL = (
        By.XPATH, "//div[@class='col-12 col-lg py-5']/div/div[2]//a")  # Локатор для второго заказа в списке

    LOCATOR_ORDER_PLACED = (By.XPATH, "//h3[text()='Размещен заказ']")  # Текст "Размещение заказа"
