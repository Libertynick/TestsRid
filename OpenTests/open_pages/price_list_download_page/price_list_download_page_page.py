import time

import allure

from base_page.base_page import BasePage
from base_page.base_page_locators import BaseOpenLocators
from open_pages.price_list_download_page.price_list_download_page_locators import PriceListDownload


@allure.feature('Страница Смотреть Прайс-Лист (скачать прайс-лист)')
class DownloadPriceListHe(BasePage):
    """Страница Смотреть Прайс-Лист (скачать прайс-лист)"""

    def download_price_pdf_he(self):
        """Скачать прайс-лист Прайс-лист «Ридан» тепловая автоматика (pdf)"""
        with allure.step('Скачать прайс-лист Прайс-лист «Ридан» тепловая автоматика (pdf)'):
            name_file = '1110932-cart_rol_12.xlsx'
            # name_file = f'2022_08_25_gabarity_i_massa_ridan_3.xlsx'
            self.delete_file_by_name_in_download_folder(name_file)

            self.waiting_for_loader_processing_on_page(BaseOpenLocators.LOCATOR_SPINNER_NO_TEXT, sec=10)
            self.expecting_clickability(PriceListDownload.LOCATOR_PRICE_LIST_RIDAN, sec=5)
            button_download_price = self.find_element(PriceListDownload.LOCATOR_PRICE_LIST_RIDAN)
            button_download_price.click()
            count_download = 0
            if count_download > 0:
                name_file = f'{name_file} ({count_download}).xlsx'
            self.checking_the_download_document_in_the_download_folder(name_file)
            count_download += 1
            self.delete_file_by_name_in_download_folder(name_file)
