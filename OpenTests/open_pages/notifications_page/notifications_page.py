import time

import allure

from base_page.base_page import BasePage
from base_page.base_page_locators import BaseOpenLocators
from open_pages.notifications_page.notifications_page_locators import NotificationsPageLocators
from open_pages.notifications_page.view_notification_page.view_notification_locators import ViewNotificationLocators


@allure.feature('Страница Уведомления')
class NotificationsPage(BasePage):
    """Страница Уведомления"""

    def choice_check_box_orders(self):
        """Выбор чек-бокса Заказы"""
        with allure.step('Выбор чек-бокса Заказы'):
            self.waiting_element_is_visibility_located_dom(NotificationsPageLocators.LOCATOR_CHECK_BOX_ORDERS, sec=30)
            check_box_orders = self.find_element(NotificationsPageLocators.LOCATOR_CHECK_BOX_ORDERS)
            check_box_orders.click()
            self.waiting_for_loader_processing_on_page(BaseOpenLocators.LOCATOR_SPINNER_NO_TEXT)
            selected_check_box_orders = check_box_orders.get_attribute('value')
            print(selected_check_box_orders)
            assert selected_check_box_orders == 'on', f'Чек-бокс Заказы не выбран. Значение - ({selected_check_box_orders})'

    def go_to_notification_by_order_number(self, num_order: str):
        """Переход в уведомление по номеру заказа"""
        with allure.step('Переход в уведомление по номеру заказа'):
            notification_by_order_number = self.find_element(
                NotificationsPageLocators.locator_notification_title_by_order_number(num_order))
            self.click_js(notification_by_order_number)
            self.waiting_for_loader_processing_on_page(BaseOpenLocators.LOCATOR_SPINNER_NO_TEXT)
            self.waiting_element_is_visibility_on_the_page(
                ViewNotificationLocators.locator_header_new_order_placed(num_order))
