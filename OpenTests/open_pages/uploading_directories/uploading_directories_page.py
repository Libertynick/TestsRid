"""Страница Выгрузка продукции Ридин"""
import allure

from base_page.base_page import BasePage
from open_pages.uploading_directories.uploading_directories_locators import UploadDirectoriesLocators
from pathlib import Path


@allure.feature('Страница Выгрузка продукции Ридин')
class UploadCatalogHE(BasePage):
    def delete_checkbox(self):
        """Убрать все чек-боксы кроме Тепловой автоматики"""
        with allure.step('Убрать все чек-боксы кроме Тепловой автоматики'):
            check_box_refrigeration_technology = self.find_element(
                UploadDirectoriesLocators.LOCATOR_CHECKBOX_REFRIGERATION_EQUIPMENT)
            self.driver.execute_script("arguments[0].click()", check_box_refrigeration_technology)

            check_box_industrial_automatics = self.find_element(
                UploadDirectoriesLocators.LOCATOR_CHECKBOX_INDUSTRIAL_AUTOMATION)
            self.driver.execute_script("arguments[0].click()", check_box_industrial_automatics)

            check_box_power_electronics = self.find_element(
                UploadDirectoriesLocators.LOCATOR_CHECKBOX_POWER_ELECTRONICS)
            self.driver.execute_script("arguments[0].click()", check_box_power_electronics)

            check_box_devi = self.find_element(
                UploadDirectoriesLocators.LOCATOR_CHECKBOX_DEVI)
            self.driver.execute_script("arguments[0].click()", check_box_devi)

            check_box_pumping_equipment = self.find_element(
                UploadDirectoriesLocators.LOCATOR_CHECKBOX_PUMPING_EQUIPMENT)
            self.driver.execute_script("arguments[0].click()", check_box_pumping_equipment)

    def upload_catalog_he(self):
        """Кнопка Выгрузить (каталог)"""
        with allure.step('Кнопка Выгрузить (каталог)'):
            button_upload_catalog = self.find_element(
                UploadDirectoriesLocators.LOCATOR_BUTTON_UPLOAD_CATALOG)
            self.driver.execute_script("arguments[0].click()", button_upload_catalog)

            name_file = f'teplovaia-avtomatika.xlsx'
            count_download = 0
            if count_download > 0:
                name_file = f'{name_file} ({count_download}).xlsx'
            self.checking_the_download_document_in_the_download_folder(name_file)
            count_download += 1
            self.delete_file_by_name_in_download_folder(name_file)

    def section_upload_price_list(self):
        """Раздел Выгрузка прайс-листа"""
        with allure.step('Раздел Выгрузка прайс-листа'):
            section_upload_price_list = self.find_element(
                UploadDirectoriesLocators.LOCATOR_BUTTON_UPLOADING_PRICE_LIST)
            self.driver.execute_script("arguments[0].click()", section_upload_price_list)
            self.waiting_element_is_visibility_on_the_page(
                UploadDirectoriesLocators.LOCATOR_HEADER_UPLOADING_PRICE_LIST)

    def button_upload_price_list(self):
        """Выгрузить Прайс-Лист"""
        with allure.step('Выгрузить Прайс-Лист'):
            radiobutton_upload_price_list_xlxs = self.find_element(
                UploadDirectoriesLocators.LOCATOR_RADIOBUTTON_UPLOAD_PRICE_XLXS)
            self.driver.execute_script("arguments[0].click()", radiobutton_upload_price_list_xlxs)
            button_upload_price_list_xlxs = self.find_element(
                UploadDirectoriesLocators.LOCATOR_BUTTON_UPLOAD_PRICE)
            self.driver.execute_script("arguments[0].click()", button_upload_price_list_xlxs)

            name_file = f'ridan-ruble-price-list.xlsx'
            count_download = 0
            if count_download > 0:
                name_file = f'{name_file} ({count_download}).xlsx'
            self.checking_the_download_document_in_the_download_folder(name_file)
            count_download += 1
            self.delete_file_by_name_in_download_folder(name_file)
