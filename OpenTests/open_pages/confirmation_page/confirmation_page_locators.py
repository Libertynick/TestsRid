from selenium.webdriver.common.by import By


class ConfirmationPageLocators:
    """Локаторы страницы Подтверждение"""

    @staticmethod
    def locator_delivery_method_at_materials(delivery_method: str):
        """Локатор способа доставки у материалов"""
        locator_delivery_method = (
            By.XPATH,
            f"//div[text()='Выберите способ доставки']/following-sibling::div[2]//span[contains(text(), '{delivery_method}')]"
        )
        return locator_delivery_method

    @staticmethod
    def locator_delivery_method_at_pto(delivery_method: str):
        """Локатор способа доставки у ПТО"""
        locator_delivery_method = (
            By.XPATH,
            f"//div[text()='Выберите способ доставки Дзержинск']/following-sibling::div[contains(@class, 'single-select-box')]//span[contains(text(), '{delivery_method}')]"
        )
        return locator_delivery_method

    @staticmethod
    def locator_delivery_address_in_drop_down_list_of_addresses(delivery_address: str):
        """Локатор адрес доставки в выпадающем списке адресов"""
        locator_delivery_address_in_drop_down_list_of_addresses = (
            By.XPATH, f"//div[@data-dadata-type='address']//ul/li[contains(text(), '{delivery_address}')]")
        return locator_delivery_address_in_drop_down_list_of_addresses

    @staticmethod
    def dynamic_payment_terms_locator(terms_of_payment: str):
        """Динамический локатор Условий оплаты
        terms_of_payment - условия оплаты
        """
        locator_terms_of_payment = (
            By.XPATH,
            f"//div[text()='Условие оплаты']/following-sibling::div[contains(@class, 'single-select-box')]//span[text()='{terms_of_payment}']")
        return locator_terms_of_payment

    @staticmethod
    def locator_count_by_article(article: str):
        """Локатор Количество по артикулу"""
        locator_count_by_article = (
            By.XPATH,
            f"//span[contains(text(), '{article}')]/ancestor::div[@class='row'][2]//div[@class='d-flex align-items-center flex-column']/span[text()]")
        return locator_count_by_article

    LOCATOR_BODY = (By.XPATH, "//body")
    LOCATOR_BUTTON_PROJECT_ORDER = (By.XPATH, "//button[text()='Проектный заказ']")  # Кнопка Проектный заказ
    LOCATOR_ALL_DISCOUNTS_CONFIRMATION = (
        By.XPATH, "//div[@class='d-flex align-items-center']")  # Все скидки на странице Подтверждение
    LOCATOR_TOTAL_COST_CONFIRMATION = (
        By.XPATH, "//span[@class='fw-bold pe-2']/span[@class='me-1']")  # Итоговая стоимость на странице Подтверждение
    LOCATOR_COMMENT_FIELD = (By.XPATH, "//textarea[@name='comment']")  # Поле ввода комментария
    LOCATOR_SHIPPING_METHOD_MATERIAL = (
        By.XPATH, "//div[text()='Выберите способ доставки']/following-sibling::div//span[text()]"
    )  # Поле выбора способа доставки для материалов
    LOCATOR_SHIPPING_METHOD_PTO = (By.XPATH, "//div[text()='Выберите способ доставки Дзержинск']/following-sibling::div"
                                   )  # Поле выбора способа доставки ПТО
    LOCATOR_SELECTED_SHIPPING_METHOD_AT_MATERIALS = (
        By.XPATH, "//div[contains(text(), 'Выберите способ доставки')]/following-sibling::div//span[text()]"
    )  # Выбранный способ доставки у материалов
    LOCATOR_SELECTED_SHIPPING_METHOD_AT_PTO = (
        By.XPATH, "//div[contains(text(), 'Выберите способ доставки Дзержинск')]/following-sibling::div//span[text()]"
    )  # Выбранный способ доставки у ПТО
    LOCATOR_INPUT_DELIVERY_ADDRESS_PTO = (By.XPATH, "//input[@name='delivery[dzerzhinsk][address][value]']"
                                          )  # Поле ввода адреса доставки ПТО
    LOCATOR_BUTTON_CONFIRM = (By.XPATH, "//button[@form='form-create-condition-order']")  # Кнопка Подтвердить
    LOCATOR_WAREHOUSE_ADDRESS_MATERIALS = (
        By.XPATH, "//div[text()='Адрес склада']/following-sibling::div//span[text()]"
    )  # Поле выбора адреса склада материалы
    LOCATOR_WAREHOUSE_ADDRESS_PTO = (
        By.XPATH, "//div[text()='Адрес склада Дзержинск']/following-sibling::div//span[text()]"
    )  # Поле выбора адреса склада ПТО
    LOCATOR_TERMS_OF_PAYMENT = (By.XPATH, "//div[text()='Условие оплаты']/parent::div//span[@class='me-2']"
                                )  # Условия оплаты
    LOCATOR_SELECTED_PAYMENT_TERMS = (By.XPATH, "//div[text()='Условие оплаты']/following-sibling::div//span[text()]"
                                      )  # Выбранные условия оплаты
    LOCATOR_HEADER_ORDER_IS_PLACED = (By.XPATH, "//h3[text()='Размещен заказ']")  # Заголовок Заказ размещен
    LOCATOR_ALL_ALLOWANCE = (
        By.XPATH,
        "//div[@class='py-2 px-3 border-bottom border-secondary']//div[@class='col-6 col-lg me-lg-0 mb-2 mb-lg-0'][2]/div"
    )  # Все надбавки на странице
    LOCATOR_CHECK_BOX_SHIPMENT_ONLY_WHEN_FULLY_ASSEMBLED = (
        By.XPATH, "//input[@class='form-check-input form-check-input__secondary']"
    )  # Чек-бокс Отгрузка только при полной комплектации
    LOCATOR_UNLOAD_BUTTON = (By.XPATH, "//button[@id='cartUnloadList']")  # Кнопка Выгрузить
    LOCATOR_BUTTON_SAVE_TO_EXCEL = (
        By.XPATH,
        "//button[@id='cartUnloadList' and @aria-expanded='true']/parent::div//button[contains(text(), 'Сохранить в Excel')]"
    )  # Кнопка Сохранить в Excel
    LOCATOR_LINKS_TO_CREATED_DKP = (By.XPATH, "//a[@class='link-primary']")  # Сслыки на созданные ДКП
    LOCATOR_BUTTON_RETURN_TO_PQ = (By.XPATH, "//a[text()='Вернуться в проектное условие']")  # Кнопка Вернуться в PQ
    LOCATOR_SHIPPING_COST_FIELD_PTO = (By.XPATH, "//input[@name='delivery[dzerzhinsk][costProductionDzerzhinsk]']"
                                       )  # Поле стоимости доставки ПТО
    LOCATOR_SHIPPING_COST_FIELD_MATERIALS = (By.XPATH, "//input[@name='delivery[moscow][costMoscow]']"
                                             )  # Поле стоимости доставки Материалы
    LOCATOR_BUTTON_CALCULATE_DELIVERY_COSTS_PTO = (
        By.XPATH, "//form[@id='form-calculation-of-delivery-cost-pto']//button"
    )  # Кнопка Рассчитать стоимость доставки ПТО
    LOCATOR_BUTTON_CALCULATE_DELIVERY_COSTS_MATERIALS = (
        By.XPATH, "//form[@id='form-calculation-of-delivery-cost']//button"
    )  # Кнопка Рассчитать стоимость доставки Материалы
    LOCATOR_INPUT_DELIVERY_ADDRESS_MATERIALS = (By.XPATH, "//input[@name='delivery[moscow][address][value]']"
                                                )  # Поле ввода адреса доставки Материалы

    LOCATOR_LOADER_BUTTON_CALCULATE_DELIVERY_COSTS = (
        By.XPATH, "//span[@class='d-inline-block animate-rotate-360-1s-linear-infinity']"
    )  # Лоадер кнопки Рассчитать стоимость доставки
    LOCATOR_CODE_IN_PQ = (By.XPATH, "//span[@class='text-break ps-3']")  # Локатор кодов в PQ на странице подтверждения
    LOCATOR_COUNT_CODE = (By.XPATH, "//div[@class='d-flex align-items-center flex-column']/span[text()]"
                          )  # Количество штук у кода
    LOCATOR_MODAL_SHOW = (By.XPATH, "//div[@id='modalDefault' and contains(@class, 'show')]"
                          )  # Модалка (любая), которая отображается на странице
