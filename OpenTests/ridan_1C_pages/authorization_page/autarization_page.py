import time
from selenium.webdriver.support import expected_conditions as EC

from selenium.webdriver.support.wait import WebDriverWait

from base_page.base_page import BasePage
from ridan_1C_pages.authorization_page.authorization_page_locators import AuthorizationPageLocators
from ridan_1C_pages.home_page.home_page_locators import HomePageLocators


# Страница авторизации
class AuthorizationPage(BasePage):
    def authorization(self, login: str, password: str):
        """Авторизация"""

        self.waiting_element_is_visibility_on_the_page(AuthorizationPageLocators.LOCATOR_HEADER_AUTHORIZATION)
        input_login = self.find_element(AuthorizationPageLocators.LOCATOR_INPUT_LOGIN)
        input_login.clear()
        input_login.send_keys(login)

        input_password = self.find_element(AuthorizationPageLocators.LOCATOR_INPUT_PASSWORD)
        input_password.clear()
        input_password.send_keys(password)

        button_to_come_in = self.find_element(AuthorizationPageLocators.LOCATOR_BUTTON_TO_COME_IN)
        button_to_come_in.click()
        time.sleep(10)

        wait = WebDriverWait(self.driver, 5)
        try:
            alert_present = wait.until(EC.alert_is_present())
            if alert_present:
                alert = self.driver.switch_to.alert
                alert.accept()
        except:
            time.sleep(1)
            self.waiting_element_is_visibility_located_dom(HomePageLocators.LOCATOR_HEADER, sec=90)
