from selenium.webdriver.common.by import By

from base_page.base_page import BasePage
from ridan_1C_pages.transportation_task_page.transportation_task_locators import TransportationTaskPageLocators


class TransportationTaskPage(BasePage):
    """Страница Задание на перевозку"""

    def select_status(self, text_status: str):
        """Выбор Статуса, text_status - текст статуса"""
        input_status = self.driver.find_elements(*TransportationTaskPageLocators.LOCATOR_INPUT_STATUS)[-1]
        input_status.clear()
        input_status.send_keys(text_status)
        locator_status_li = (By.XPATH, f"//div[text()='{text_status}']")
        self.waiting_element_is_visibility_on_the_page(locator_status_li)
        status = self.find_element(locator_status_li)
        status.click()
        self.waiting_element_invisibility(locator_status_li)
        input_status_selected = self.driver.find_elements(*TransportationTaskPageLocators.LOCATOR_INPUT_STATUS)[-1]
        input_status_selected = input_status_selected.get_attribute("value")
        assert input_status_selected == text_status, f'Выбранный статус ({input_status_selected}) ' \
                                                     f'не равен искомому ({text_status})'

    def click_button_run_and_close(self):
        """Клик по кнопке Провести и закрыть"""
        button_run_and_close = self.find_element(TransportationTaskPageLocators.LOCATOR_BUTTON_RUN_AND_CLOSE)
        button_run_and_close.click()

