from selenium.webdriver.common.by import By


class ObjectsPageLocators:
    """Локаторы страницы Объекта"""

    @staticmethod
    def locator_add_kp(chapter: str):
        """Кнопка Создать КП
        chapter - раздел
        """
        locator_add_kp = (
            By.XPATH,
            f"//b[contains(text(), '{chapter}')]//ancestor::div[@class='panel-heading engSpec-header']//a[text()=' КП']"
        )
        return locator_add_kp

    @staticmethod
    def locator_button_edit_pq(num_pq: str):
        """Локатор Редактирование PQ по номеру"""
        # locator_button_edit_pq = (By.XPATH, f"//b[text()='{num_pq}']/ancestor::tr//a[@title='Редактировать']"
        locator_button_edit_pq = (
            By.XPATH,
            f"//a[@data-number='{num_pq}']/preceding-sibling::a[@title='Редактировать' and contains(@data-id, 'id')]"
        )
        return locator_button_edit_pq

    @staticmethod
    def locator_total_price_pq_in_chapter_kp(num_pq: str):
        """Локатор общей стоимости PQ во вкладке КП"""
        locator_total_price_pq_in_chapter_kp = (
            By.XPATH,
            f"//a[@data-number='{num_pq}']/parent::td/following-sibling::td/span[contains(text(), 'Всего')]"
        )
        return locator_total_price_pq_in_chapter_kp
    LOCATOR_LOADER_KP_TAB = (By.XPATH, "//div[@class='dynamic-objects-loader' and not(@style='display: none;')]"
                             )  # Лоадер на вкладке КП
    LOCATOR_INFO_OBJECT_TITLE = (
        By.XPATH, "//div[text()='Информация об объекте']")  # Заголовок меню Информация об объекте
    LOCATOR_ADD_KP_BTP_TP = (
        By.XPATH,
        "//b[contains(text(), 'ТП')]//ancestor::div[@class='panel-heading engSpec-header']//a[text()=' КП с БТП']"
    )  # Кнопка Создать КП БТП на ТП(тепловой раздел), возвращается список
    LOCATOR_CHAPTER_KP = (By.XPATH, "//a[@title='КП']")  # Раздел КП
    LOCATOR_EDIT_PQ_BUTTON = (
        By.XPATH, "//a[@title='КП']/following::a[@title='Редактировать']")  # Кнопка Редактировать PQ
    LOCATOR_LIST_PQ_NUMBER = (By.XPATH, "//b[contains(., 'PQ')]")  # Список номеров PQ на странице
    LOCATOR_EDIT_OBJECT = (By.XPATH, "//a[@title='Редактировать']")  # Кнопка редактировать объект
    LOCATOR_BUTTON_PLUS_POTENTIAL = (By.XPATH, "//a[@class='btn btn-info btn-sm btn-add-engSpec']")  # Кнопка +Потенциал
    LOCATOR_STATUS_PROCESSED_AT_THE_TP_SECTION = (
        By.XPATH, "//span[@class='engSpecDesc']/span[contains(text(),'Обработано')]")
    # Проверка появлнения статуса Обработано у добавленного инженерного раздела
    LOCATOR_CHAPTER_PARTICIPANTS = (By.XPATH, "//a[@title='Участники']")  # Раздел Участники
    LOCATOR_BUTTON_ADD_A_PARTICIPANT = (By.XPATH, "//a[contains(text(), 'Добавить')]")  # Кнопка Добавить Участника
    LOCATOR_PARTICIPANTS_NAME_DESIGNER = (
        By.XPATH, "//tbody//tr//td[2]//div//span")  # Локатор ФИО Участника (Когда он 1 на объекте)
    LOCATOR_PARTICIPANTS_ROLE_DESIGNER = (
        By.XPATH, "//span[contains(@title, 'Роль участника')]")  # Локатор роли во вкладке Участники
    LOCATOR_NUMBER_OBJECT = (By.XPATH, "//div[@title='Номер объекта']")  # Номер объекта
    LOCATOR_ADDRESS_OBJECT = (By.XPATH, "//div[@class='address-holder']//span[text()]"
                              )  # Адрес объекта
    LOCATOR_SECTION_TVU_WITH_STATUS_UNPROCESSED = (
        By.XPATH, "//b[contains(text(), 'ТВУ')]/following-sibling::span[text()='Не обработано']")
    # Локатор раздела со статусом "Не обработано"
    LOCATOR_BUTTON_PLUS_DESK_REPORT = (By.XPATH, "//a[contains(@class, 'btn-add-desk')]")
    # Кнопка "+Desk отчет" в раскрытом разделе со статусом "Не обработано"
    LOCATOR_OBJECT_LOADER = (
        By.XPATH,
        "//div[@class='container record-holder-container view noprint']/div[@class='dynamic-objects-loader']"
        "//div[@class='loader']")  # Лоадер на странице Объекты
    LOCATOR_CHECK_SECTION_STATUS_TVU_PROCESSED = (
        By.XPATH, "//b[contains(text(), 'ТВУ')]/following-sibling::span[text()='Обработано']")
    # Раздел ТВУ в статусе Обработано


class EditObjectLocators:
    """Страница редактирования объекта"""
    LOCATOR_CHANGE_CHECK_STATUS = (By.XPATH,
                                   "//div[@select2='checkedStatus']/div[@class='select2-container filter-select2-input input-sm select2-allowclear']")
    # Открыть список в поле Статус Проверки
    LOCATOR_CHOOSE_CHECK_STATUS = (By.XPATH, "//div[text()='Объект проверен']")
    # Выбор статуса объекта Объект проверен
    LOCATOR_CHOOSE_CHECK_STATUS_TRASH = (By.XPATH, "//div[text()='Мусорный объект']")
    # Выбор статуса объекта Мусорный
    LOCATOR_SAVE_CHANGE = (By.XPATH, "//button[@class='btn btn-success btn-modal-save']")
    # Кнопка "Сохранить" изменения
    LOCATOR_LOADER_TEXT = (By.XPATH, "//input[@class='select2-input select2-active']")
    # Ожидание загрузки пролоадера при выборе статуса


class ParticipantsTabLocators:
    """Локаторы вкладки Участники"""

    @staticmethod
    def locator_participant_role(name_organization_participant: str):
        """Локатор Роль участника"""
        locator_participant_role = (
            By.XPATH, f"//a[text()='{name_organization_participant}']/parent::b/following-sibling::span")
        return locator_participant_role

    LOCATOR_BUTTON_MEMBER_CHANGE_HISTORY = (By.XPATH, "//a[@title='История изменений участника на объекте']"
                                            )  # Кнопка История изменений участника на объекте
    LOCATOR_LINK_PARTICIPANT = (By.XPATH, "//span[contains(@title, 'Роль участника:')]/preceding-sibling::b/a"
                                )  # Ссылка на участника (организацию)
    LOCATOR_LOADER_PARTICIPANTS_TAB = (By.XPATH, "//div[@class='filterInstanceHolder']//div[@class='loader']"
                                       )  # Лоадер вкладки Участники
    LOCATOR_BUTTON_ADD_A_PARTICIPANT = (By.XPATH, "//a[contains(text(), 'Добавить')]")  # Кнопка Добавить Участника


class ModalNewParticipantsLocators:
    """Модальное окно при добавлении нового Участника на объекте"""

    @staticmethod
    def locator_btn_select_participant_by_organization_name(name_organization: str):
        """Локатор кнопка Выбрать участника по названию организации"""
        locator_btn_select_participant_by_organization_name = (By.XPATH, f"//button[@data-txt='{name_organization}']")
        return locator_btn_select_participant_by_organization_name

    LOCATOR_INPUT_SEARCH_FIELD_BY_NAME = (
        By.XPATH, "//input[@placeholder='Поиск по названию, коду, ИНН, Деб.счёт SAP']")
    # Поле поиска по названию, коду, ИНН и пр
    LOCATOR_BUTTON_SEARCH = (By.XPATH, "//a[@class='btn btn-success btn-sm btn-search']")
    # Кнопка Найти участника
    LOCATOR_CHOOSE_PARTICIPANTS = (By.XPATH, "//button[text()='Выбрать']")


class EditingParticipantsLocators:
    """Модальное окно Редактирование участника"""

    @staticmethod
    def locator_result_search_participant_contact_by_name(contact_name: str):
        """Локатор результат поиска контакта участника по имени"""
        locator_result_search_participant_contact_by_name = (By.XPATH, f"//span[contains(text(), '{contact_name}')]")
        return locator_result_search_participant_contact_by_name

    LOCATOR_HEADER_EDIT_PARTICIPANTS = (By.XPATH, "//h4[contains(text(), 'Редактирование участника')]")
    # Заголовок модального окна "Редактирование участника"
    LOCATOR_HEADER_LINK_NAME_ORGANIZATION = (By.XPATH, "//a[@field='ContractorName']"
                                             )  # Заголовок в виде ссылки с названием организации
    LOCATOR_INPUT_SPECIFY_ROLE = (By.XPATH, "//div[@select2='roles']//input")
    # Поле ввода выбора Роли
    LOCATOR_CHOOSE_ROLE_ADMIN = (By.XPATH, "//div[contains(text(), 'Адм-ция города')]")
    # Есть в списке участник Адм-ция города
    LOCATOR_CHOOSE_ROLE_DESIGNER = (By.CSS_SELECTOR, "ul.select2-results li.select2-results-dept-0:nth-child(1) ")
    # Выбор проектировщика из списка
    LOCATOR_CONTACT_FIELD = (By.XPATH, "//div[@select2='persons']//input")
    # Поле ввода Контакты
    LOCATOR_SELECTED_CONTACT_PARTICIPANT = (By.XPATH, "//div[@select2='persons']//span[text()]"
                                            )  # Выбранный контак участника в поле ввода контакта
    LOCATOR_EMAIL_FOUND_CONTACT = (By.XPATH, "//a[contains(text(), 'Valiev@ridan.ru')]")
    # Почта Валиева (искомого контакта)
    LOCATOR_CHOOSE_ELEMENT_IN_LIST_CONTACT = (
        By.CSS_SELECTOR, "ul.select2-results li.select2-results-dept-0:nth-child(1)")
    # Выбор первого элемента из спика при поиске контактного лица
    LOCATOR_INPUT_ENGINEERING_DEPARTMENT = (By.XPATH, "//div[@select2='specTypes']//input")
    # Поле ввода Инженерного раздела
    LOCATOR_ENGINEERING_DEPARTMENT_TP = (
        By.XPATH, "//div[contains(text(), 'ТП/Кот (Тепловой Пункт/Котельная)')]")
    # Поле из списка инженерных разделов Тепловой пункт
    LOCATOR_BUTTON_SAVE_PARTICIPATS_ON_OBJECT = (By.XPATH, "//button[@name='save']")
    # Кнопка Сохранить в модальном окне Редактирование Участника
    LOCATOR_LOADER_MODAL_EDIT_PARTICIPANT = (
        By.XPATH, "//div[@class='container-fluid projectMemberItem']/following-sibling::div[1]//div[@class='loader']"
    )  # Лоадер в модалке редактирования участника


class WindowEditDeskReport:
    """Модально окно редактирования Desk отчета"""
    LOCATOR_HEADER_IN_MODAL_DESK = (By.XPATH, "//h4[text()='DESK-отчёт']")  # Заголвоок в модалке Desk- отчет
    LOCATOR_FIELD_FOR_ADDING_CODE_NUMBERS = (By.XPATH, "//textarea[@field='codes']")
    # Поле для ввода кодовых номеров
    LOCATOR_BUTTON_ADD_POSITIONS = (By.XPATH, "//div[@field='btnAddPositions']/a")
    # Кнопка Добавить позиции
    LOCATOR_TABLE_FIRST_ELEMENT = (By.XPATH, "(//input[@field='positionOrder'])[1]")
    # Локатор первого номера в списке добавленных кодов
    LOCATOR_CATEGORIES_PAGE = (By.XPATH, "//a[@class='categories-page']")
    # Кнопка Категории
    LOCATOR_TABLE_CHOOSE_CATEGORIES = (By.XPATH, "//span[contains(text(), 'Латунные шаровые краны')]")
    # Локатор первой категории в таблице при выборе Бренда
    LOCATOR_FIRST_FIELD_FOR_BRAND_SELECTION = (By.XPATH, "//div[@field='categories']//tr[1]//td[5]//a")
    # Первое поле для выбора бренда на странице Категории
    LOCATOR_SECOND_FIELD_FOR_BRAND_SELECTION = (By.XPATH, "//div[@field='categories']//tr[2]//td[5]//a")
    # Второе поле для выбора бренда на странице Категории
    LOCATOR_THIRD_FIELD_FOR_BRAND_SELECTION = (By.XPATH, "//div[@field='categories']//tr[3]//td[5]//a")
    # Третье поле для выбора бренда на странице Категории
    LOCATOR_CHOOSE_BRAND = (By.CSS_SELECTOR, "ul.select2-results li.select2-results-dept-0:nth-child(6)")
    # Локатор выбора 6 Бренда в выпадающем списке
    LOCATOR_FIELD_COMMENTARY = (By.XPATH, "//input[@field='comment']")
    # Поле комментарий в деск отчете
    LOCATOR_ADD_FILE = (By.XPATH, "//div[@field='files']//input")
    # Локатор для загрузки файла в деск отчете
    LOCATOR_WAIT_VISIBLE_NAME_FILE = (By.XPATH, "(//a[contains(text(), 'for_CleverDesk.pdf')])[2]")
    # Локатор того что файл загрузился
    LOCATOR_SAVE_REPORT = (By.XPATH, "//button[contains(@class, 'btn-modal-save')]")
    # Кнопка Сохранить деск отчет
    LOCATOR_LOADER_EDIT_CODE_DESK_REPORT = (By.XPATH, "//div[@field='actCallRecalc']//"
                                                      "following-sibling::div[@class='dynamic-objects-loader']"
                                                      "//div[@class='loader']")
    # Лоадер на странице добавления кодов в деск отчет
