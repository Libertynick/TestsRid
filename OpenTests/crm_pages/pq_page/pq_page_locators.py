from selenium.webdriver.common.by import By


# Страница PQ
class PqPageLocators:

    @staticmethod
    def locator_special_price_icon_by_article(article: str):
        """Иконка Спец цена по артикулу"""
        locator_special_price_icon_by_article = (
            By.XPATH,
            f"//b[text()='{article}']/parent::a//following-sibling::a[@class='label label-info' and text()='Спеццена']"
        )
        return locator_special_price_icon_by_article

    @staticmethod
    def locator_total_price_by_num_dkp(num_dkp: str):
        """Локатор итоговой суммы по номеру ДКП вида PQxxxxxxx"""
        locator_total_price_by_num_dkp = (
            By.XPATH,
            f"//div[@id='childOffers']//tr[@data-id]//b[contains(text(), '{num_dkp}')]/ancestor::tr//span[contains(text(), 'Всего:')]")
        return locator_total_price_by_num_dkp

    @staticmethod
    def locator_category_gcm_sum_distr(category: str):
        """Локатор суммы с НДС дистра по категории"""
        locator_category_gcm_sum_distr = (
            By.XPATH, f"//div[@field='discountGroup' and contains(text(), '{category}')]")
        return locator_category_gcm_sum_distr

    @staticmethod
    def locator_category_gcm(category: str):
        """Локатор категории ГЦМ в счете"""
        locator_category_gcm = (By.XPATH, f"//div[@field='discountGroup' and contains(text(), '{category}')]")
        return locator_category_gcm

    @staticmethod
    def locator_btn_agreement_true_by_type_agreement(type_agreement: str):
        """Кнопка Согласовать (зеленая галочка) по типу согласования"""
        locator_btn_agreement_true_by_type_agreement = (
            By.XPATH,
            f"//td[contains(text(), '{type_agreement}')]/parent::tr//div[@class='btn btn-default btn-sm btn-approve-step' and not(@disabled)]//span[@title='Вы можете согласовать данный шаг']")
        return locator_btn_agreement_true_by_type_agreement

    @staticmethod
    def locator_coordinators_by_type_agreement(type_agreement: str):
        """
        Согласователи по типу согласования
        :param type_agreement: Тип согласования
        :return: Согласователи
        """
        locator_coordinators_by_type_agreement = (
            By.XPATH,
            f"//td[contains(text(), '{type_agreement}')]/parent::tr/td[@column-num='2']//div[text()]")
        return locator_coordinators_by_type_agreement

    @staticmethod
    def locator_description_pto_by_article(article: str):
        """Описание пто по артикулу
        :param article: Артикул
        :return: Локатор Описание у артикула пто
        """
        locator_description_by_article = (
            By.XPATH,
            f"//b[contains(text(), '{article}')]/parent::div[@field='description' and contains(text(), 'по расчёту')]")
        return locator_description_by_article

    @staticmethod
    def locator_description_by_pump_article(article: str):
        """
        Описание у артикула насоса
        :param article: Артикул
        :return: Локатор описание у артикула насоса
        """
        locator_description_by_pump_article = (
            By.XPATH,
            f"//b[contains(text(), '{article}')]/parent::div[@field='description' and contains(text(), 'Насосная станция')]")
        return locator_description_by_pump_article

    @staticmethod
    def locator_status_agreement_by_type_agreement(type_agreement: str):
        """Локатор Статус согласования по виду согласования"""
        locator_status_agreement_by_type_agreement = (
            By.XPATH, f"//td[@column-num='1' and contains(normalize-space(), '{type_agreement}')]//span[text()]"
        )
        return locator_status_agreement_by_type_agreement

    LOCATOR_LOADER = (By.XPATH, "//div[@class='status-container bordered']//div[@class='loader']")
    LOCATOR_LOADER_SAVE_PQ = (
        By.XPATH,
        "//div[@class='status-container bordered']//div[@class='text-holder' and contains(text(), 'Сохраняем')]"
    )  # Лоадер Сохраняем ...
    LOCATOR_LOADER_SEND = (
        By.XPATH,
        "//div[@class='status-container bordered']//div[@class='text-holder' and contains(text(), 'Отправляем')]"
    )  # Лоадер Отправляем
    LOCATOR_LOADER_PQ_PAGE = (
        By.XPATH, "(//div[@id='offerAdditionalParameters']//div[@class='text-holder'])[last()]")  # Лоадер
    LOCATOR_LOADER_BUILDING_AN_APPROVAL_PLAN = (
        By.XPATH,
        "//div[@class='status-container bordered']//div[@class='text-holder' and contains(text(), 'Построение плана согласования')]"
    )  # Лоадер Построение плана согласования
    LOCATOR_HEADER_KP = (By.XPATH, "//small[text()='КП']")  # Заголовок КП
    LOCATOR_FLAG_AGREEMENT = (By.XPATH, "//span[@class='label label-warning' and contains(text(), 'Согласование')]"
                              )  # Флаг Согласование в заголовке страницы КП
    LOCATOR_FLAG_AGREED_OR_AGREEMENT_TITLE_KP = (
        By.XPATH,
        "//span[@class='label label-warning' and contains(text(), 'Согласование')] | //span[@class='label label-success' and contains(text(), 'Согласовано')]"
    )  # Флаг Согласовано или Согласование в заголовке КП
    LOCATOR_DELIVERY_AGREEMENT_FLAG = (By.XPATH, "//td[text()='Доставка ']")  # Флаг Согласования Доставки
    LOCATOR_CREDIT_CONTROL_AGREEMENT_FLAG = (
        By.XPATH, "//td[text()='Кредитный контроль ']")  # Флаг согласования Кредитный контроль
    LOCATOR_AGREEMENT_TRUE = (
        By.XPATH,
        "//div[@class='btn btn-default btn-sm btn-approve-step' and not(@disabled)]//span[@title='Вы можете согласовать данный шаг']"
    )  # Галочка согласования
    LOCATOR_BTN_APPROVE_LOGISTICS = (By.XPATH, "//div[contains(@class, 'btn-approve-step-logistics')]"
                                     )  # Кнопка согласования Логистика
    LOCATOR_BTN_CONSENT_FAILURE = (
        By.XPATH, "//span[@title='Вы можете отказать в согласовании данного шага']//parent::div"
    )  # Кнопка Отказ согласования
    LOCATOR_BTN_CONSENT_FAILURE_HEX = (
        By.XPATH,
        "//td[contains(text(), 'Согласование HEX')]/parent::tr//div[@class='btn btn-default btn-sm btn-decline-step']"
    )  # Кнопка Отказ согласования HEX
    LOCATOR_H4_AGREEMENT = (
        By.XPATH, "//h4[contains(text(), 'Согласование')]")  # Заголовок Согласование в модалке согласования
    LOCATOR_HEADER_AGREEMENT_HEX = (By.XPATH, "//div[@field='allApproves']//div[contains(text(), 'Согласование HEX')]"
                                    )  # Заголовок "Согласование HEX" в модалке согласования
    LOCATOR_FIELD_COMMENT = (By.XPATH, "//textarea[@field='comment']")  # Поле ввода комментария
    LOCATOR_APPROVE_BUTTON_IN_THE_APPROVAL_MODAL = (
        By.XPATH, "//button[text()='Согласовать']")  # Кнопка Согласовать в модалке Согласования
    LOCATOR_BUTTON_REJECT_IN_THE_APPROVAL_MODAL = (By.XPATH, "//button[@name='action']"
                                                   )  # Кнопка Отклонить в модалке согласования
    LOCATOR_BUTTON_CREATE_ACCOUNT = (By.XPATH, "//p[text()='Создать счёт']/parent::a")  # Кнопка Создать счет
    LOCATOR_A_CREATED_ACCOUNT = (By.XPATH, "//a[contains(@title, 'Просмотр заказа')]")  # Ссылка на созданный счет в PQ
    LOCATOR_NUM_DKP = (
        By.XPATH, "//div[@id='childOffers']//tr[@data-id]//b[contains(text(), 'PQ') or contains(text(), 'IND')]"
    )  # Номер ДКП (вида PQxxxxxxxx-x)
    LOCATOR_NUM_ORDER_IN_TITLE_PQ = (By.XPATH, "//div[@field='title']//span[contains(text(), 'RT')]"
                                     )  # Номер заказа в заголовке КП
    LOCATOR_TOTAL_AMOUNT_DKP_IN_ORDERS_SECTION = (By.XPATH, "//span[contains(text(), 'Всего:')]"
                                                  )  # Итоговая сумма ДКП в разделе Заказы
    LOCATOR_PRICE_KP = (By.XPATH, "//span[@field='distributorAmountNdsTolal']")  # Стоимость КП
    LOCATOR_NAME_ARTICLE = (By.XPATH, "//div[@field='description']//b")  # Артикул товара
    LOCATOR_DESCRIPTION_ARTICLE = (By.XPATH, "//div[@field='description']/span[text()]"
                                   )  # Описание артикула
    LOCATOR_CONSOLIDATION_CHECKBOX = (
        By.XPATH, "//span[@class='glyphicon glyphicon-unchecked']")  # Чекбокс согласования
    LOCATOR_ORANGE_AGREEMENT_FLAGS = (
        By.XPATH, "//span[@class='label label-warning' and contains(text(), 'в процессе')]"
    )  # Оранжевые флаги согласования
    LOCATOR_BLUE_AGREEMENT_FLAGS = (By.XPATH, "//span[@class='label label-info']")  # голубые флаги согласования
    LOCATOR_SURNAME_OF_THE_CONTRACTOR_ORANGE_FLAG = (
        By.XPATH, "//span[@class='label label-warning']/parent::td/following-sibling::td[@column-num='2']//div[text()]"
    )  # Фамилия согласователя с оранжевым флагом
    LOCATOR_SURNAME_CONTRACTORS_HEX = (By.XPATH, "//td[contains(text(), 'Согласование HEX')]/parent::tr//div[text()]"
                                       )  # Согласователи HEX
    LOCATOR_SURNAME_OF_THE_CONTRACTOR_BLUE_FLAG = (
        By.XPATH, "//span[@class='label label-info']/parent::td/following-sibling::td//div[text()]"
    )  # Фамилия согласователя с синим флагом

    LOCATOR_INPUT_QUANTITY_OF_GOODS_IN_THE_ORDER = (By.XPATH, "//input[@field='value']")  # Количество товара в заказе
    LOCATOR_TOTAL_PRICE_PQ = (By.XPATH, "//span[@field='distributorAmountNdsTolal']")  # Итоговая сумма КП
    LOCATOR_TOTAL_COST_CLIENT = (By.XPATH, "//div[@field='clientAmountNdsTotal']")  # Итого стоимость клиента

    LOCATOR_CLOSE_PQ = (By.XPATH, "//button[@class='btn-link close']")  # Кнопка закрытия КП (крестик)

    LOCATOR_DELIVERY_PAYMENT_MODE = (By.XPATH, "//div[text()='Режим оплаты']/following-sibling::div[1]//span[1]"
                                     )  # Режим оплаты доставки
    LOCATOR_SALESMAN = (By.XPATH, "//div[@caption-field='Seller']/parent::div//span[@class='select2-chosen']"
                        )  # Продавец

    LOCATOR_ALLOWANCE = (By.XPATH, "//div[@field='surcharge']")  # Поле значения надбавки

    LOCATOR_LENDING_DURATION = (By.XPATH, "//input[@field='payZ']")  # Поле Продолжительность кредитования, дней

    LOCATOR_TRANSPORTATION_COST = (By.XPATH, "//input[@field='transportationCostRUB']")  # Сумма транспортных расходов

    LOCATOR_TEXT_MATERIAL_PTO = (
        By.XPATH, "//div[contains(text(), 'Аппарат теплообменный')]")  # Поле с описанием материала ПТО

    LOCATOR_POSITION = (By.XPATH, "//input[@field='positionOrder']")  # Нумерация позиций в счете

    LOCATOR_DISCOUNTS_DISTR = (By.XPATH, "//input[@field='distrAdditionalConditions']")  # Скидки дистра
    LOCATOR_TOTAL_PAYMENT_BEFORE_SHIPMENT = (By.XPATH, "//input[@field='paymentBeforeShipment']"
                                             )  # Суммарная оплата перед отгрузкой
    LOCATOR_ADVANCE_PAYMENT = (By.XPATH, "//input[@field='payPercentBeforePlacingIntoProduction']"
                               )  # размер аванса для размещения
    LOCATOR_LOAN_DURATION = (By.XPATH, "//input[@field='payZ']")  # Продолжительность кредитования
    LOCATOR_PRICE_CRM = (By.XPATH, "//span[@field='distributorAmountNdsTolal']")
    LOCATOR_OFF_DISCOUNTS = (
        By.XPATH,
        "//div[@class='alert alert-warning']//div[text()= 'Скидки']/../div[@class='mc-type-container no-border']//span"
    )  # Поле для отключения согласования Скидки
    LOCATOR_OFF_DISCOUNTS_DD = (
        By.XPATH,
        "//div[@class='alert alert-warning']//div[text()= 'Скидки ДД']/../div[@class='mc-type-container no-border']//span"
    )  # Поле для отключения согласования Скидки ДД
    LOCATOR_PAYMENT_TERMS = (By.XPATH, "//div[@select2='paymentTerm']//span[text()]")  # Условие оплаты
    LOCATOR_PAYMENT_TERMS_CODE = (By.XPATH, "//div[@field='settedPayCode']//div[2]")  # Код условий оплаты
    LOCATOR_CP_APPROVAL_HEADER_FROM_CLIENT = (By.XPATH, "//div[text()='КП от клиента']"
                                              )  # Заголовок согласования КП от клиента
    LOCATOR_APPROVAL_TOGGLE_SWITCHES_IN_MODAL = (By.XPATH, "//div[@switcher='selected']/span"
                                                 )  # Тумблеры согласований в модалке Согласование КП
    LOCATOR_ALL_APPROVALS_EXCEPT_KP_FROM_CLIENT = (
        By.XPATH,
        "//div[@switcher='selected']/parent::div/following-sibling::div[not(text()='КП от клиента')]/preceding-sibling::div//span[@class='switchery switchery-small']"
    )  # Все согласователи кроме КП от клиента
    LOCATOR_DELIVERY_CONDITIONS = (By.XPATH, "//div[@select2='deliveryTerms']//a/span[1]/b")  # Условия поставки
    LOCATOR_LINK_TO_CREATED_ORDER = (By.XPATH, "//a[contains(@title, 'Просмотр заказа')]")  # Ссылка на созданный заказ
    INPUT_CURRENCY_DATE = (By.XPATH, "//input[@field='currencyDate']")  # Поле ввода даты курса
    LOCATOR_BTN_KIT_CONTENTS = (By.XPATH, "//div[@field='btnShowBom']")  # Кнопка Состав комплекта
    LOCATOR_HEADER_IN_MODAL_KIT_CONTENTS = (
        By.XPATH, "//div[@class='header-container']/h4[contains(text(), 'Состав комплекта')]"
    )  # Заголовок в модалке Состав комплекта
    LOCATOR_ARTICLE_IN_MODAL_KIT_CONTENTS = (
        By.XPATH, "//h4[contains(text(), 'Состав комплекта')]//ancestor::div[@class='modal-content']//tr/td[1]"
    )  # Артикулы в модалке Состав комплекта
    LOCATOR_COST_APPROVAL_BUTTON = (
        By.XPATH, "//div[@data-step-name='CheckCost']//span[@class='glyphicon glyphicon-refresh']"
    )  # Кнопка согласования себестоимости (устаревшей)
    LOCATOR_INFO_MESSAGE_IN_COST_PRICE_APPROVAL_BLOCK = (
        By.XPATH, "//div[@data-step-name='CheckCost']/ancestor::table//td[@colspan='3']/span[text()]"
    )  # Информационное сообщение в блоке согласования себестоимости
    LOCATOR_FLAG_AGREED_BY_DZERZHINSK_PLANT = (
        By.XPATH, "//td[contains(text(), 'Завод Дзержинск')]/span[contains(text(), 'согласовано')]"
    )  # флаг согласовано завод Дзержинск
    LOCATOR_POTENTIAL_MODE = (By.XPATH, "//div[@select2='purchaseType']//span[text()]"
                              )  # Режим потенциала
    LOCATOR_AMOUNT_WITH_NDS_DISTR_IN_POSITION = (By.XPATH, "//div[@field='distrAmountNds']/span"
                                                 )  # Сумма с НДС Дистра по позиции
    LOCATOR_REFRESH_SUPPLEMENTARY = (By.XPATH, "//div[@field='refreshSupplementary']/a")
    # Кнопка Пересоздать документы (БТП)
    LOCATOR_REFRESH_SHORT_SUPPLEMENTARY = (By.XPATH, "//div[@field='refreshShortSupplementary']/a ")
    # Кнопка Пересоздать документы в сокращенном виде (БТП)
    LOCATOR_DOP_SUPPLEMENTARY = (By.XPATH, "//a[contains(text(), 'Доп соглашение по БТП.pdf')]")
    # Документ доп. соглашение на БТП
    LOCATOR_FILE_DOP_SUPPLEMENTARY = (By.XPATH,
                                      "//div[@title='Файлы, отображаемые в личном кабинете клиента на сайте ridan.ru']"
                                      "/../div[@field='files']//div[@class='total clickable']")
    # Прикреплено файлов, там где лежат доп. соглашения
    LOCATOR_PDF_SHORT_SUPPLEMENTARY = (By.XPATH, "//a[contains(text(), 'Сокращенное_доп_соглашение_по_БТП.pdf')]")
    # Локатор файла сокращенное доп. соглашение на БТП
    LOCATOR_VERIFICATION_OF_AGREEMENT_DEN = (By.XPATH, "//td[contains(text(), 'Согласование DEN ')]")
    # Локатор появления согласование DEN
    LOCATOR_SURNAME_CONTRACTORS_DEN = (By.XPATH, "//td[contains(text(), 'Согласование DEN ')]/parent::tr//div[text()]"
                                       )  # Согласователи DEN
    LOCATOR_SURNAME_LOOSE_KP = (By.XPATH, "//td[contains(text(), 'Незакрепленное КП')]/parent::tr//div[text()]"
                                )  # Согласователи Незакрепленное КП
    LOCATOR_INPUT_COMMENT_REJECT_KP = (By.XPATH, "//textarea[@field='comment']")
    # Локатор файла сокращенное доп. соглашение на БТП
    LOCATOR_REJECT_LOOSE_KP = (By.XPATH, "(//div[@class='btn btn-default btn-sm btn-decline-step'])[1]")
    LOCATOR_CATEGORY_IN_INVOICE = (By.XPATH, "//div[@field='discountGroup']")  # Локатор Группы ГЦМ в счете и в КП
    LOCATOR_STATUS_KP_IN_TITLE = (By.XPATH, "//div[@field='title']//span[contains(@class, 'label')]"
                                  )  # Статус КП в заголовке
    LOCATOR_BLOCK_WITH_APPROVAL = (By.XPATH, "//table[@class='b3 table table-hover table-condensed']"
                                   )  # Блок на странице с согласователями
    LOCATOR_TD_LINE_IN_BLOCK_APPROVAL = (By.XPATH, "//table[@class='b3 table table-hover table-condensed']//td"
                                         )  # Разделы td в блоке с согласователями
    LOCATOR_BTN_CANCEL_APPROVAL = (By.XPATH, "//div[@field='actCancelApprovement']/a")  # Кнопка Отменить согласование
    LOCATOR_PRICE_COST_TOTAL = (By.XPATH, "//div[@id='odFooterCostTotal']")  # Общая себестоимость в кп
