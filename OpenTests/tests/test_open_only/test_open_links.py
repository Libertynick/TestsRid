import allure
import pytest

from base_page.base_page import BasePage


@allure.feature('Опеновские тесты')
@allure.story('Проверка работоспособности страниц')
@pytest.mark.stage
@pytest.mark.parametrize('base_url', ['https://ruecom-open-tst1.ridancorp.net'])
def test_open_links(browser, base_url):
    """Проверка работоспособности страниц без падения"""

    links = [
        '/distributors-and-service-partners',
        '/contacts',
        '/help',
        '/help/nacalo-raboty-s-portalom',
        '/help/nacalo-raboty-s-portalom/registraciya',
        '/help/question_kak-zaregistrirovatsya-na-portale',
        '/price-lists',
        '/documentation',
        '/catalog-export',
        '/pr/instrumenty-podbora',
        '/wiki',
        '/wiki/ecl4-control',
        '/wiki/ecl4-control/ecl4-control-368',
        '/wiki/question_obshh',
        '/solutions-by-industry',
        '/cases',
        '/pr/teplovaya-avtomatika',
        '/pr/xolodilnaya-texnika',
        '/pr/privodnaya-texnika',
        '/pr/promyslennaya-avtomatika',
        '/pr/o-kompanii',
        '/pr/standarty-kacestva',
        '/pr/polzovatelskoe-soglasenie',
        '/pr/globalnaya-politika-xraneniya-dannyx-kompanii-ridan',
        '/news',
        '/news/coolconfig-podbor-obviazki-xolodilnoi-masiny-onlain',
        '/catalog',
        '/catalog/thermal-automation',
        '/catalog/thermal-automation/radiatornye-termoregulyatory-i-klapany',
        '/catalog/thermal-automation/radiatornye-termoregulyatory-i-klapany/termostaticeskie-elementy-radiatornyx-termoregulyatorov',
        '/catalog/thermal-automation/radiatornye-termoregulyatory-i-klapany/termostaticeskie-elementy-radiatornyx-termoregulyatorov/termostaticeskie-elementy-serii-tr-ridan',
        '/instruments/configurator-btp',
        '/instruments/configurator-pto',
        '/instruments/configurator-pto/standard',
        '/instruments/configurator-pto/gvs2',
        '/instruments/configurator-sha',
        '/instruments/configurator-sha/settings-questionnaire',
        '/instruments/heat-config',
        '/instruments/heat-select',
        '/instruments/dcad',
        '/instruments/configurator-tdu',
        '/calculators/heating-device',
        '/instruments/dcad/hydraulic',
        '/instruments/configurator-bphe/evaporation',
        '/instruments/configurator-bphe/check-evaporation',
        '/instruments/configurator-bphe/single-phase',
        '/instruments/coolconfig',
        '/calculators/supply-unit',
        '/instruments/configurator-pumps',
        '/instruments/configurator-pumpstations',
        '/cleverdesk',
        '/search/analogs',
        '/search',
        '/sales/cart',
        '/register',
        '/restore-password',
        '/applications/buildings',
        '/applications/food',
        '/applications/infrastructure',
        '/applications/industry',
        '/industries/15-let-konstruiruem-budushhee-vmeste',
        '/support/service'
    ]

    prod_open_link = 'https://ridan.ru'
    if base_url != prod_open_link:
        links = [
            '/distributors-and-service-partners',
            '/contacts',
            '/help',
            '/help/nacalo-raboty-s-portalom',
            '/help/nacalo-raboty-s-portalom/registraciya',
            '/documentation',
            '/price-lists',
            '/catalog-export',
            '/wiki',
            '/wiki/ecl4-control',
            '/wiki/ecl4-control/ecl4-control-368',
            '/solutions-by-industry',
            '/cases',
            '/news',
            '/catalog',
            '/catalog/thermal-automation',
            '/catalog/thermal-automation/radiatornye-termoregulyatory-i-klapany',
            '/catalog/thermal-automation/radiatornye-termoregulyatory-i-klapany/termostaticeskie-elementy-radiatornyx-termoregulyatorov',
            '/instruments/configurator-btp',
            '/instruments/configurator-pto',
            '/instruments/configurator-pto/standard',
            '/instruments/configurator-pto/gvs2',
            '/instruments/configurator-sha',
            '/instruments/configurator-sha/settings-questionnaire',
            '/instruments/heat-config',
            '/instruments/heat-select',
            '/instruments/dcad',
            '/instruments/configurator-tdu',
            '/calculators/heating-device',
            '/instruments/dcad/hydraulic',
            '/instruments/configurator-bphe/evaporation',
            '/instruments/configurator-bphe/check-evaporation',
            '/instruments/configurator-bphe/single-phase',
            '/instruments/coolconfig',
            '/calculators/supply-unit',
            '/instruments/configurator-pumps',
            '/instruments/configurator-pumpstations',
            '/cleverdesk',
            '/search/analogs',
            '/search',
            '/sales/cart',
            '/register',
            '/restore-password',
            '/support/service'
        ]

    links = [base_url + el for el in links]

    page = BasePage(browser, links)
    result_test = page.link_not_fall(links)
    print(result_test)
    assert len(result_test) == 0, f'Упавшие ссылки {result_test}'
