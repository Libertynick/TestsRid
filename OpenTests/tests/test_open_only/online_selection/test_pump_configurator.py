import allure
import pytest
from open_pages.main_page.main_page import MainPage
from config import ProdEnvironment
from open_pages.header.header_page import Header

from open_pages.selection_online_tools_all.pump_selection.pump_select_page import PumpPage
from open_pages.selection_tools_modal.selection_tools_modal import SelectionToolsModalPage, PumpChapter


@allure.feature('Опеновские тесты')
@allure.story('Подбор насосов')
@pytest.mark.prod
def test_pump_configurator(browser):
    """Подбор насосов"""
    # Действия на Главной странице
    page = MainPage(browser, ProdEnvironment.OPEN_URL)
    page.open()
    page.authorization_from_main_page(ProdEnvironment.EMAIL_OPEN_PROD, ProdEnvironment.PASSWORD_OPEN_PROD)

    # Переход в модалку Инструменты подбора
    page = Header(browser, ProdEnvironment.OPEN_URL)
    page.go_to_option_tools()

    # Переход в подбор насосов
    page = SelectionToolsModalPage(browser, ProdEnvironment.OPEN_URL)
    page.click_tab_pump()

    page = PumpChapter(browser, ProdEnvironment.OPEN_URL)
    page.go_to_pump()

    # Ввод данных для подбора
    page = PumpPage(browser, ProdEnvironment.OPEN_URL)
    page.switch_to_frame_pump()
    value_cons = '200'
    page.type_consumpyion(value_cons)

    value_power = '10'
    page.type_power(value_power)

    # Подбор по данным
    page.button_pick_up()
    page.results_table()

    # Сохранение расчет
    page.button_save()
