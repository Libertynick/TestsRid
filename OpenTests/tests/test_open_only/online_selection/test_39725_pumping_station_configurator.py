import allure
import pytest

from config import TestEnvironment
from open_pages.main_page.main_page import MainPage
from open_pages.selection_online_tools_all.pumping_station_configurator_page.pumping_station_configurator_page import \
    PumpingStationConfiguratorPage


@allure.feature('Опеновские тесты')
@allure.story('39725 Конфигуратор насосных станций')
@pytest.mark.stage
def test_39725_pumping_station_configurator(browser):
    """39725 Конфигуратор насосных станций"""
    system_type = 'Циркуляция'
    system_flow = '10'  # Расход системы
    required_pressure = '5'  # Требуемый напор
    value_total_number_of_pumps = '2'  # Общее количество насосов

    link_configurator_pump_station = 'https://ruecom-open-tst1.ridancorp.net/instruments/configurator-pumpstations'

    page = MainPage(browser, TestEnvironment.LINK_OPEN_TST)
    page.open()
    page.authorization_from_main_page(TestEnvironment.LOGIN_TST_VODOKOMFORT, TestEnvironment.PASSWORD_TST_VODOKOMFORT)

    page = PumpingStationConfiguratorPage(browser, link_configurator_pump_station)
    page.open()
    page.configurator_description_should_not_be_empty()
    page.switch_to_frame_configurator()
    page.switch_to_frame_selection_of_pumping_station()
    page.activating_system_type_drop_down_list()
    page.system_type_selection(system_type)
    page.entering_system_flow(system_flow)
    page.entering_required_pressure(required_pressure)
    page.activation_of_control_cabinet_drop_down_menu()
    page.selection_of_control_cabinet_c_r_p_for_each_pump()
    page.activation_total_number_of_pumps_drop_down_menu()
    page.selecting_a_value_in_menu_total_number_of_pumps(value_total_number_of_pumps)
    page.check_box_selection_without_taking_into_account_losses_on_equipment_must_be_selected()
    # page.select_region(name_region)
    page.click_btn_select()
    page.name_of_selected_module_must_not_be_empty()
