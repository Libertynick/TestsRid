import allure
import pytest

from config import TestEnvironment
from open_pages.header.header_page import BlockSearch
from open_pages.main_page.main_page import MainPage
from open_pages.searching_results_page.searching_results_page import SearchingResultsPage


@pytest.mark.parametrize('article', ['013G7070R'])
def product_search_in_open(browser, article: str, link_open: str, login: str, password: str):
    """Поиск товара в Опене"""

    page = MainPage(browser, link_open)
    page.open()
    page.authorization_from_main_page(login, password)

    page = BlockSearch(browser, link_open)
    page.enter_article_in_search_field(article)
    page.click_btn_search(article)

    page = SearchingResultsPage(browser, link_open)
    page.go_to_product_page(article)


@pytest.mark.skip(reason='Есть тесты tests.test_open_only.test_35140_personal_area_end_user.test_open_links и '
                         'tests.test_open_only.test_35139_personal_area_distr.test_open_links. Делают тоже самое')
@allure.feature('Опеновские тесты')
@allure.story('Поиск товара в Опене')
@pytest.mark.stage
@pytest.mark.parametrize('article', ['013G7070R'])
@pytest.mark.parametrize('link_open', ['https://ruecom-open-tst1.ridancorp.net'])
@pytest.mark.parametrize('login', [TestEnvironment.LOGIN_TST_VODOKOMFORT])
@pytest.mark.parametrize('password', [TestEnvironment.PASSWORD_TST_VODOKOMFORT])
def test_40436_product_search_in_open(browser, article, link_open, login, password):
    """"Поиск товара в Опене"""
    product_search_in_open(browser, article, link_open, login, password)
